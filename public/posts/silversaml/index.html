<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Meet Silver SAML: Golden SAML in the Cloud | TomerN</title>
<meta name="keywords" content="">
<meta name="description" content="Key Findings

Golden SAML, an attack technique that exploits the SAML single sign-on protocol, was used as a post-breach exploit, compounding the devastating SolarWinds attack of 2020, one of the largest breaches of the 21st century.
The supply chain SolarWinds attack affected thousands of organizations around the world, including the US Government. Attackers deployed malicious code into the company’s Orion IT management and monitoring software.
In the wake of this attack, CISA and cybersecurity experts encouraged organizations with hybrid identity environments to move SAML authentication to a cloud identity system such as Entra ID.
Tomer Nahum and Eric Woodruff have discovered a new application of Golden SAML, one that can be exploited even in organizations that have followed previous security recommendations meant to defend against Golden SAML.
The new attack technique, dubbed Silver SAML, enables the exploitation of SAML to launch attacks from an identity provider like Entra ID against applications configured to use it for authentication, such as Salesforce.
To our knowledge, no attacks using Silver SAML have been reported.
We rate this vulnerability as Moderate, with a potential increase to Severe.

Golden SAML is a known attack technique discovered by CyberArk and published by Shaked Reiner. (Remember Golden SAML attack that compounded the damage from the SolarWinds cyberattack, aka Solorigate?) For years, Golden SAML has been known for its extraction of signing certificates from Active Directory Federation Services (AD FS) and its use of those certificates to forge SAML authentication responses. Today, we present a new application of Golden SAML—in Microsoft Entra ID and without the use of AD FS. Meet Silver SAML.">
<meta name="author" content="Tomer Nahum, Eric Woodruff">
<link rel="canonical" href="http://localhost:1313/posts/silversaml/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.a59eb1fe3d954acf19e87bac091377a5f9194d1458a08ac191d3da5c9eb2b3f2.css" integrity="sha256-pZ6x/j2VSs8Z6HusCRN3pfkZTRRYoIrBkdPaXJ6ys/I=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/silversaml/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><html>

<body>

</body>
</html><meta property="og:url" content="http://localhost:1313/posts/silversaml/">
  <meta property="og:site_name" content="TomerN">
  <meta property="og:title" content="Meet Silver SAML: Golden SAML in the Cloud">
  <meta property="og:description" content="Key Findings Golden SAML, an attack technique that exploits the SAML single sign-on protocol, was used as a post-breach exploit, compounding the devastating SolarWinds attack of 2020, one of the largest breaches of the 21st century. The supply chain SolarWinds attack affected thousands of organizations around the world, including the US Government. Attackers deployed malicious code into the company’s Orion IT management and monitoring software. In the wake of this attack, CISA and cybersecurity experts encouraged organizations with hybrid identity environments to move SAML authentication to a cloud identity system such as Entra ID. Tomer Nahum and Eric Woodruff have discovered a new application of Golden SAML, one that can be exploited even in organizations that have followed previous security recommendations meant to defend against Golden SAML. The new attack technique, dubbed Silver SAML, enables the exploitation of SAML to launch attacks from an identity provider like Entra ID against applications configured to use it for authentication, such as Salesforce. To our knowledge, no attacks using Silver SAML have been reported. We rate this vulnerability as Moderate, with a potential increase to Severe. Golden SAML is a known attack technique discovered by CyberArk and published by Shaked Reiner. (Remember Golden SAML attack that compounded the damage from the SolarWinds cyberattack, aka Solorigate?) For years, Golden SAML has been known for its extraction of signing certificates from Active Directory Federation Services (AD FS) and its use of those certificates to forge SAML authentication responses. Today, we present a new application of Golden SAML—in Microsoft Entra ID and without the use of AD FS. Meet Silver SAML.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-02-29T22:35:48+03:00">
    <meta property="article:modified_time" content="2024-02-29T22:35:48+03:00">
      <meta property="og:image" content="http://localhost:1313/images/tomer.jpg">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://localhost:1313/images/tomer.jpg">
<meta name="twitter:title" content="Meet Silver SAML: Golden SAML in the Cloud">
<meta name="twitter:description" content="Key Findings

Golden SAML, an attack technique that exploits the SAML single sign-on protocol, was used as a post-breach exploit, compounding the devastating SolarWinds attack of 2020, one of the largest breaches of the 21st century.
The supply chain SolarWinds attack affected thousands of organizations around the world, including the US Government. Attackers deployed malicious code into the company’s Orion IT management and monitoring software.
In the wake of this attack, CISA and cybersecurity experts encouraged organizations with hybrid identity environments to move SAML authentication to a cloud identity system such as Entra ID.
Tomer Nahum and Eric Woodruff have discovered a new application of Golden SAML, one that can be exploited even in organizations that have followed previous security recommendations meant to defend against Golden SAML.
The new attack technique, dubbed Silver SAML, enables the exploitation of SAML to launch attacks from an identity provider like Entra ID against applications configured to use it for authentication, such as Salesforce.
To our knowledge, no attacks using Silver SAML have been reported.
We rate this vulnerability as Moderate, with a potential increase to Severe.

Golden SAML is a known attack technique discovered by CyberArk and published by Shaked Reiner. (Remember Golden SAML attack that compounded the damage from the SolarWinds cyberattack, aka Solorigate?) For years, Golden SAML has been known for its extraction of signing certificates from Active Directory Federation Services (AD FS) and its use of those certificates to forge SAML authentication responses. Today, we present a new application of Golden SAML—in Microsoft Entra ID and without the use of AD FS. Meet Silver SAML.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Meet Silver SAML: Golden SAML in the Cloud",
      "item": "http://localhost:1313/posts/silversaml/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Meet Silver SAML: Golden SAML in the Cloud",
  "name": "Meet Silver SAML: Golden SAML in the Cloud",
  "description": "Key Findings Golden SAML, an attack technique that exploits the SAML single sign-on protocol, was used as a post-breach exploit, compounding the devastating SolarWinds attack of 2020, one of the largest breaches of the 21st century. The supply chain SolarWinds attack affected thousands of organizations around the world, including the US Government. Attackers deployed malicious code into the company’s Orion IT management and monitoring software. In the wake of this attack, CISA and cybersecurity experts encouraged organizations with hybrid identity environments to move SAML authentication to a cloud identity system such as Entra ID. Tomer Nahum and Eric Woodruff have discovered a new application of Golden SAML, one that can be exploited even in organizations that have followed previous security recommendations meant to defend against Golden SAML. The new attack technique, dubbed Silver SAML, enables the exploitation of SAML to launch attacks from an identity provider like Entra ID against applications configured to use it for authentication, such as Salesforce. To our knowledge, no attacks using Silver SAML have been reported. We rate this vulnerability as Moderate, with a potential increase to Severe. Golden SAML is a known attack technique discovered by CyberArk and published by Shaked Reiner. (Remember Golden SAML attack that compounded the damage from the SolarWinds cyberattack, aka Solorigate?) For years, Golden SAML has been known for its extraction of signing certificates from Active Directory Federation Services (AD FS) and its use of those certificates to forge SAML authentication responses. Today, we present a new application of Golden SAML—in Microsoft Entra ID and without the use of AD FS. Meet Silver SAML.\n",
  "keywords": [
    
  ],
  "articleBody": "Key Findings Golden SAML, an attack technique that exploits the SAML single sign-on protocol, was used as a post-breach exploit, compounding the devastating SolarWinds attack of 2020, one of the largest breaches of the 21st century. The supply chain SolarWinds attack affected thousands of organizations around the world, including the US Government. Attackers deployed malicious code into the company’s Orion IT management and monitoring software. In the wake of this attack, CISA and cybersecurity experts encouraged organizations with hybrid identity environments to move SAML authentication to a cloud identity system such as Entra ID. Tomer Nahum and Eric Woodruff have discovered a new application of Golden SAML, one that can be exploited even in organizations that have followed previous security recommendations meant to defend against Golden SAML. The new attack technique, dubbed Silver SAML, enables the exploitation of SAML to launch attacks from an identity provider like Entra ID against applications configured to use it for authentication, such as Salesforce. To our knowledge, no attacks using Silver SAML have been reported. We rate this vulnerability as Moderate, with a potential increase to Severe. Golden SAML is a known attack technique discovered by CyberArk and published by Shaked Reiner. (Remember Golden SAML attack that compounded the damage from the SolarWinds cyberattack, aka Solorigate?) For years, Golden SAML has been known for its extraction of signing certificates from Active Directory Federation Services (AD FS) and its use of those certificates to forge SAML authentication responses. Today, we present a new application of Golden SAML—in Microsoft Entra ID and without the use of AD FS. Meet Silver SAML.\nWhat is Silver SAML? Today, many organizations use Entra ID as the identity provider (IdP) for software-as-a-service (SaaS) and line-of-business (LOB) applications. SAML is the primary means of authentication for these applications.\nWithin Entra ID, Microsoft provides a self-signed certificate for SAML response signing. Alternatively, organizations can choose to use an externally generated certificate. However, that option introduces a security risk.\nAny attacker that obtains the private key of an externally generated certificate can forge any SAML response they want and sign that response with the same private key that Entra ID holds. With this type of forged SAML response, the attacker can then access the application-as any user.\nThe proof of concept discussed in this post focuses on Entra ID. But this attack can take advantage of any IdP that allows the import of externally generated SAML signing certificates.\nFor the sake of this proof of concept, we built and published a new tool, called SilverSAMLForger, that can be used to forge signed SAML responses. You can find SilverSAMLForger on GitHub.\nBackground: SAML, Golden SAML, and the SolarWinds attack SAML is a staple of modern authentication. For example, 63 percent of Entra ID Gallery applications rely on SAML for integration. Multi-cloud integrations with Amazon Web Services (AWS), Google Cloud Platform (GCP), and others rely on SAML. And many organizations continue to invest in SAML for SaaS and LOB applications because of the simplicity of its implementation.\nGolden SAML and Solorigate As part of the global supply chain attack on SolarWinds (aka Solorigate), Golden SAML was one of the attackers’ more innovative attack vectors.\nThe attackers gained initial access to SolarWinds by inserting malicious code into the company’s Orion Platform, used for infrastructure monitoring and IT management. Later, the attackers used this foothold to move laterally into the AD FS environment. From there, they stole the private key material used to sign SAML responses.\nAs a result of this post-breach Golden SAML attack, many organizations prioritized the move of applications to Entra ID for SAML authentication. This change removed the need to manage a complex Tier 0 infrastructure, and SAML signing keys cannot be exported from Entra ID. Even CISA recommends that organizations with hybrid identity environments move SAML authentication to cloud identity systems such as Entra ID.\nThe trouble with SAML and signing certificates Unfortunately, many organizations mismanage signing certificates and weaken SAML security by using externally generated certificates. From our observations, enterprise organizations tend to:\nGenerate self-signed signing certificates on a client system Generate signing certificates through an enterprise public key infrastructure (PKI), such as Active Directory Certificate Services (AD CS) Obtain and use signing certificates from an external certificate authority (CA) Adding to the problem, we then see organizations that take these externally generated certificates and:\nSend certificate PFX files and passwords through insecure channels such as Teams or Slack Generate certificates on client machines, leaving the certificates available for export in the machines’ local certificate store Generate certificates on web servers, typically running Microsoft Internet Information Services (IIS), leaving the certificates available for export in the machines’ local certificate store Even for organizations that use services such as Azure Key Vault—a more secure method for secret and certificate management—attack vectors can exist. (We will cover those vectors in the next section.)\nUsing an externally generated certificate for SAML response signing greatly increases the attack surface of any IdP, including Entra ID. We have observed several common lessons in organizations that generate and manage SAML signing certificates externally, rather than directly within Entra ID.\nLack of a chain of trust with self-signed certificates from Entra ID Inability to leverage certificate revocation with self-signed certificates Need to apply a defined corporate policy blindly to certificate management (usually based on one or both of the previous reasons) A subjective feeling that self-signed certificates are “less secure” Additionally, some organizations want to maintain a SAML signing certificate lifetime longer than the Entra ID default. These organizations issue external certificates, not realizing that they can simply issue new certificates from Entra ID and configure those certificates to have a longer lifetime.\nMany organizations do not understand the nuances of leveraging certificates for SAML signing; signing certificates are simply swept up into their broader certificate management directives and policies. Although common certificate lifecycle and management practices are important to many types of systems, they do not and should not apply to certificates that are used for SAML signing.\nA chain of trust is not relevant in SAML. Most IdPs and Service Provider (SP) applications ignore any chain of trust. Unlike the server/client scenario you see with web browsers, an administrator is effectively an essential part of the chain of trust in SAML configurations. The administrator must configure and specify which signing certificate to trust, specifically in the application.\nNor is certificate revocation a relevant practice with SAML. If a signing certificate is compromised, an administrator must rotate (i.e., replace) that certificate in the SP and IdP. OASIS SAML 2.0 Metadata Interoperability Profile Version 1.0 specifically indicates to refrain from using revocation lists, Online Certificate Status Protocol (OCSP), or other mechanisms for key validation. Instead, you should have the IdP remove compromised keys from the SAML metadata.\nImporting external certificates As Figure 1 shows, you can configure self-signed certificates on an enterprise application (Okta, in this example) in the Entra admin center via the application’s Manage \u003e Single sign-on \u003e SAML \u003e SAML Certificates settings.\nFigure 1. Configuring self-signed SAML certificates on a service principal in Entra ID [SSOPage.png]\nIn the SAML Signing Certificate pane, you can import your own certificate to sign the SAML response or assertions (Figure 2).\nFigure 2. Importing SAML certificates on a service principal in Entra ID [CertificatePage.png]\nWhat about Azure Key Vault? We need to take a moment to talk about Azure Key Vault: one of the places where self-signed certificates might be stored. We wanted to determine whether an attacker could extract keys from Key Vault. Spoiler: They can. (If your organization does not use Key Vault, feel free to jump to the next section.)\nAzure Key Vault is a popular key-management solution provided by Microsoft. Key Vault enables you to securely store and manage secrets, encryption keys, and certificates.\nAs with most cloud services, Key Vault has two planes that govern access and management: the control plane and the data plane.\nControl plane. Roles and permissions assigned to the control plane are associated with administrative tasks and Key Vault configuration settings. Users, groups, or service principals that are assigned control plane permissions can configure access policies, create key vaults, and perform other management tasks. Rights can be granted granularly to an individual vault but are often granted at the resource group, subscription, or management group level. Data plane. The data plane relates to the actual data stored in a key vault: secrets, keys, and certificates. Rights assigned on the data plane control which users or service principals can read and write cryptographic material to and from the key vault. These rights include the ability to read certificate private keys, which is a concern if those keys are used for SAML response signing. Key Vault permissions can be granted through role-based access control (RBAC) or Key Vault access policies.\nThe RBAC permissions model With the RBAC model (Figure 3), any user that holds one of the following RBAC roles can retrieve a key vault’s certificate.\nKey Vault Administrator Key Vault Certificates Officer Key Vault Data Access Administrator. This role enables you to manage access by adding or removing role assignments. Therefore, you can assign the Key Vault Administrator or Key Vault Certificates Officer role to any entity. Key Vault Contributor. This role does not grant data plane permissions but enables you to update the key vault’s access policy if the access policies permission model is also used. Figure 3. Specifying roles in Azure Key Vault [KeyVaultIAM.png]\nFigure 4 shows an example of the permissions that are granted to the Key Vault Administrator role.\nFigure 4. Key Vault Administrator role permissions [KeyAdminPerms.png]\nA person who holds the Key Vault Contributor role, which has no data plane permissions to access the key vault secrets and certificates, can still extract them if access policies are used. This role does have the Microsoft.KeyVault/* control plane permission. This permission can be translated to Microsoft.KeyVault/vaults/accessPolicies/write, enabling the holder to write Key Vault access policies and extract key vault secrets.\nIf you can add RBAC permissions at the resource group or subscription level, by gaining control of a resource group owner account or a user account that has the Role Based Access Control Administrator RBAC permission or any user with Microsoft.Authorization/roleAssignments/write permission, you can add Key Vault permissions. The key vault will then inherit those permissions. As mentioned earlier, some RBAC roles can also directly modify Key Vault access policies.\nKey vaults can also be accessed via Automation accounts and Managed Identities that have the required permissions.\nThe Key Vault access policies permissions model In this model, you can also grant Key Vault access permissions to a user, service, or group. You can choose between key permissions, secret permissions, and certificate permissions (Figure 5).\nFigure 5. Key Vault certificate permissions [VaultAccessPolicies.png]\nYou can add access policies in the Key Vault Access policies pane (Figure 6).\nFigure 6. Adding Key Vault access policies [KeyVaultAccessPolicies.png]\nAny attacker that gains control of any user, service principal, or group that has permission to retrieve the PFX file that is used to sign the SAML assertions or responses for the attacked SP—through either RBAC or Key Vault access policies—can perform a Silver SAML attack on that SP.\nSAML and Entra ID SAML, in its current 2.0 version, is almost 20 years old. OASIS published the protocol in March 2005. Since then, many enterprises have adopted SAML for federated authentication and web-based SSO solutions. The protocol’s primary implementation—and the use case within Entra ID—is leveraging the web browser SSO profile.\nA typical SAML profile flow has three core components:\nThe service provider (SP), or application; also commonly referred to as the relying party (RP) in the Microsoft ecosystem The identity provider (IdP), which in our proof of concept is Entra ID The user agent, typically a client’s (end user’s) web browser Users interact with applications for authentication in various ways, depending on whether the application is configured for or supports SP-initiated or IdP-initiated flows.\nIn an SP-initiated flow (Figure 7), the following sequence occurs:\nThe user browses to a URL for the application (SP). The SP generates a SAML request (Figure 8) and redirects the user to Entra ID (IdP). Entra ID consumes the SAML request. If the user has not yet authenticated to Entra ID, the user is prompted for authentication. The user successfully authenticates to Entra ID. Entra ID generates a SAML response (Figure 9) and redirects the user to the SP. The SP verifies the SAML response. The user receives access to the application. Figure 7. SP-initiated flow diagram\nFigure 8. Example of a SAML authentication request [SAMLRequest.png]\nFigure 9. Example of a SAML response [SAMLResponseExample.png]\nIn an IdP-initiated flow (Figure 10), the following sequence occurs:\nThe user browses to myapps.microsoft.com. If the user has not yet authenticated to Entra ID, the user is prompted for authentication. The user successfully authenticates to Entra ID. Entra ID provides a list of applications available to the user in myapps.microsoft.com. The user selects the target application. Entra ID generates a SAML response and redirects the user to the SP. The SP verifies the SAML response. The user receives access to the application. Figure 10. IdP-initiated flow diagram\nThe contents of a SAML assertion includes several bits of information about the end user, or subject, in a series of key-value pairs. This information is often referred to as SAML claims and includes information such as:\nThe subject. The application uses this required component as the user’s unique identifier. In many implementations, the subject is the user’s User Principal Name (UPN) or email address. Attribute information. This information might include the user’s given name, surname, email address, and display name. Group membership or roles are often provided so that the application can make authorization decisions about which rights the user should have. Other authentication contextual information. This information might include the type of authentication used, the issuer and audience, and timestamp information that indicates the window of validity for the SAML response. How do you ensure that the SAML response, which is handled by the user, has not been tampered with? This is where signing comes into play.\nEntra ID supports both SAML response and SAML assertion signing. At a high level, the purpose of both response and assertion signing is to verify that the contents of the response have not been tampered with and that the application can trust the information in the response. The application uses the signature to validate that the response was generated by the IdP, which holds the private key used to sign the response.\nThis is why theft of the signing private key is a critical issue. With the signing key in hand, a threat actor can forge a copy of a SAML response, performing a Silver SAML attack.\nPerforming a Silver SAML attack To test the theory that the Golden SAML attack technique can be turned against Entra ID—in what we have dubbed a Silver SAML attack—we built the SilverSAMLForger tool. This tool generates a SAML response that duplicates an Entra ID response, signing that response with a provided certificate.\nOur Silver SAML proof of concept is built on the premise that an organization is using an externally generated signing certificate, which an attacker has obtained by using one of the previously discussed methods. We look at applying Silver SAML in both SP-initiated flows and IDP-initiated flows, as both are susceptible to attack.\nSilver SAML in an SP-initiated flow Silver SAML attack using Entra ID as the IdP and Okta as the SP. To launch the attack in an SP-initiated flow, we needed to intercept the SAML request and replace the contents of the SAML response with the forged SAML response that we created (Figure 11). We were able to accomplish these tasks easily by using Burp Suite.\nFigure 11. Silver SAML attack in an SP-initiated flow\nFor this example, we attempted to forge a SAML response for the user oktaAdministrator@xd6z7.onmicrosoft.com. This user is a Super Administrator in Okta. We do not have the user’s password or the user’s MFA connected device (if configured).\nFirst, we needed some attributes in the SAML claims information in accordance with what was set up when the application was registered on the IdP. For example, we need the UPN, surname, firstname, displayName, and objectID. An attacker can easily find these attributes in the Entra admin center or by using the Microsoft Graph API.\nWe also needed to know the recipient and audience. That information was available in the Entra admin center, in the application’s Single sign-on pane (Figure 12).\nFigure 12. Identifying the signing recipient and audience [SSOSettings.png]\nRunning SilverSAMLForger.exe with the required parameters output a base64 and URL encoded string (Figure 13). We can now copy this forged SAML response. .\nFigure 13. SAML generated response [SAMLGeneratedResponse.png]\nWe copied the generated SAML response to the intercepted HTTPS request (Figure 14) and modified the response to the forged one (Figure 15).\nFigure 14. Copying the SAML response to the intercepted HTTPS request [BurpRequestURL.png]\nFigure 15. Changing the SAML response [BurpIntercept.png]\nAfter sending the forged response, we can stop intercepting as we are now logged in as the targeted user (Figure 16). Figure 16. Successful sign-in as the target user [SuccessfulSignInOktaAdmin.png]\nSilver SAML attack in an IdP-initiated flow IdP-initiated flows come with a much greater risk to the organization because no interaction is required with Entra ID. If the application supports IdP-initiated flows, you can directly post a SAML response to the application (Figure 17).\nFigure 17. Silver SAML attack in an IdP-initiated flow\nFor this part of the proof of concept, we tried to perform an IdP-initiated attack against Salesforce.\nWe targeted the user Patti Fernandez, forging a response with her UPN as the subject. The response (Figure 17) was signed using the same SAML signing certificate that was configured for Salesforce in Entra ID.\nFigure 18. SAML response [SalesForceForging.png] (The pictures looks a bit different from the one here cause we updated the pic)\nDecoding this response, you can see that it’s a forged response for Patti (Figure 18).\nFigure 19. Silver SAML attack in an SP-initiated flow\nIn Burp Suite, we used Repeater to directly post the forged SAML response to our instance of Salesforce (Figure 19).\nFigure 20. Posting a forged SAML response\nOpening the response in a browser, we verified that we are logged into Salesforce as Patti, without any interaction with Entra ID (Figure 20).\nFigure 21. Logging on to Salesforce with a forged SAML response\nDefending against Silver SAML attacks To safeguard effectively against Silver SAML attacks in Entra ID, your organization should use only Entra ID self-signed certificates for SAML signing purposes.\nSAML signing certificates are stored in the service principal for a SAML application in Entra ID. You can use the Graph API to view the information that is exposed about the signing key. Simply call a GET request to the following URI: https://graph.microsoft.com/beta/servicePrincipals/{serviceprincipalobjectid}\nFigure 22 shows an example of the exposed information. Note that the private key material is not exportable, preventing attackers from gathering the information they need to launch a Silver SAML attack.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 { \"customKeyIdentifier\": \"Gk//vUF/JYC58HRyyuGMM5ydmOuJVUL74R6OszKQn6w=\", \"endDateTime\": \"2026-08-08T14:19:35Z\", \"keyId\": \"66ad0fe4-111d-45da-924c-545913d77be9\", \"startDateTime\": \"2023-08-08T14:19:36Z\", \"type\": \"AsymmetricX509Cert\", \"usage\": \"Sign\", \"key\": null, \"displayName\": \"CN=Microsoft Azure Federated SSO Certificate\", \"hasExtendedValue\": null } Figure 22. Exposed signing key information\nGlobal Administrators, Application Administrators, Cloud Application Administrators, and any user who is delegated application ownership can modify which signing keys are available, and can import an external signing key. Although the associated application will need to be updated, organizations should limit who has ownership over applications in Entra ID. At the very least, monitor for changes to SAML signing keys, especially if the key is not near its expiration.\nOrganizations can audit existing service principals that are configured for SAML and check the displayName. If the used certificate is generated by Microsoft, the certificate will contain the value CN=Microsoft Azure Federated SSO Certificate. However, nothing prevents an attacker from importing an external certificate that has the same subject name.\nOrganizations can also monitor Entra ID audit logs for changes to PreferredTokenSigningKeyThumbprint under ApplicationManagement. You will need to correlate those events to Add service principal credential events that relate to the service principal. The rotation of expired certificates is a common process, so you will need to determine whether the audit events are legitimate. Implementing change control processes to document the rotation can help to minimize confusion during rotation events.\nIf an application supports both SAML and OpenID Connect (OIDC) for authentication, you might consider changing the integration with Entra ID to use OIDC, mitigating this attack. The complexity of changing from SAML to OIDC largely depends on how the application developer has implemented the standards.\nOn the app side, application developers can protect against attacks in a few ways. (Your options will depend on the methods and libraries used in your SAML implementation.) Require SP-initiated flows, which protect against IdP-initiated flows—the most dangerous types of attacks. For SP-initiated flows, follow the SAML specification and ensure that responses contain an InResponseTo value that correlates to an associated SAML request. Observe the time in which the application receives a SAML response. The IdP indicates a window of validity in the response, but application developers can introduce further logical limitations to the acceptable window for receiving a response in SP-initiated flows. Offer the choice of using OIDC, instead of SAML, for integration. Don’t let Silver SAML take you by surprise Like the Golden SAML attack, Silver SAML attacks have the potential to be mild—or devastating. As the adoption of cloud and hybrid identity environments continues to grow, we expect to see more threats aimed at IdPs like Entra ID. We encourage organizations to take decisive steps now to close gaps and vulnerabilities in these environments.\nDisclosure This issue was reported via the Microsoft Security Response Center (MSRC) on January 2, 2024. Microsoft replied on February 26, 2024: “After careful investigation, this case has been assessed as by-design and does not meet MSRC’s bar for immediate servicing. However, we have shared the report with the team responsible for maintaining the product or service. They will take appropriate action as needed to help keep customers protected.”\nTimeline January 2, 2024: MSRC case created\nJanuary 3, 2024: Case status changed to Review/Reprod\nFebruary 17, 2024: MSRC review of research article\nFebruary 26, 2024: MSRC response received\nFebruary 29, 2024: Public disclosure\n",
  "wordCount" : "3747",
  "inLanguage": "en",
  "image": "http://localhost:1313/images/tomer.jpg","datePublished": "2024-02-29T22:35:48+03:00",
  "dateModified": "2024-02-29T22:35:48+03:00",
  "author":[{
    "@type": "Person",
    "name": "Tomer Nahum"
  }, {
    "@type": "Person",
    "name": "Eric Woodruff"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/silversaml/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "TomerN",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="TomerN (Alt + H)">TomerN</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/opensourceprojects/" title="Open Source Projects">
                    <span>Open Source Projects</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Meet Silver SAML: Golden SAML in the Cloud
    </h1>
    <div class="post-meta"><span title='2024-02-29 22:35:48 +0300 +0300'>February 29, 2024</span>&nbsp;·&nbsp;Tomer Nahum, Eric Woodruff

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#key-findings" aria-label="Key Findings">Key Findings</a><ul>
                        
                <li>
                    <a href="#what-is-silver-saml" aria-label="What is Silver SAML?">What is Silver SAML?</a></li>
                <li>
                    <a href="#background-saml-golden-saml-and-the-solarwinds-attack" aria-label="Background: SAML, Golden SAML, and the SolarWinds attack">Background: SAML, Golden SAML, and the SolarWinds attack</a><ul>
                        
                <li>
                    <a href="#golden-saml-and-solorigate" aria-label="Golden SAML and Solorigate">Golden SAML and Solorigate</a></li>
                <li>
                    <a href="#the-trouble-with-saml-and-signing-certificates" aria-label="The trouble with SAML and signing certificates">The trouble with SAML and signing certificates</a></li>
                <li>
                    <a href="#importing-external-certificates" aria-label="Importing external certificates">Importing external certificates</a></li></ul>
                </li>
                <li>
                    <a href="#what-about-azure-key-vault" aria-label="What about Azure Key Vault?">What about Azure Key Vault?</a><ul>
                        
                <li>
                    <a href="#the-rbac-permissions-model" aria-label="The RBAC permissions model">The RBAC permissions model</a></li>
                <li>
                    <a href="#the-key-vault-access-policies-permissions-model" aria-label="The Key Vault access policies permissions model">The Key Vault access policies permissions model</a></li></ul>
                </li>
                <li>
                    <a href="#saml-and-entra-id" aria-label="SAML and Entra ID">SAML and Entra ID</a></li>
                <li>
                    <a href="#performing-a-silver-saml-attack" aria-label="Performing a Silver SAML attack">Performing a Silver SAML attack</a><ul>
                        
                <li>
                    <a href="#silver-saml-in-an-sp-initiated-flow" aria-label="Silver SAML in an SP-initiated flow">Silver SAML in an SP-initiated flow</a></li>
                <li>
                    <a href="#silver-saml-attack-in-an-idp-initiated-flow" aria-label="Silver SAML attack in an IdP-initiated flow">Silver SAML attack in an IdP-initiated flow</a></li></ul>
                </li>
                <li>
                    <a href="#defending-against-silver-saml-attacks" aria-label="Defending against Silver SAML attacks">Defending against Silver SAML attacks</a></li>
                <li>
                    <a href="#on-the-app-side-application-developers-can-protect-against-attacks-in-a-few-ways-your-options-will-depend-on-the-methods-and-libraries-used-in-your-saml-implementation" aria-label="On the app side, application developers can protect against attacks in a few ways. (Your options will depend on the methods and libraries used in your SAML implementation.)">On the app side, application developers can protect against attacks in a few ways. (Your options will depend on the methods and libraries used in your SAML implementation.)</a></li>
                <li>
                    <a href="#dont-let-silver-saml-take-you-by-surprise" aria-label="Don’t let Silver SAML take you by surprise">Don’t let Silver SAML take you by surprise</a></li>
                <li>
                    <a href="#disclosure" aria-label="Disclosure">Disclosure</a></li>
                <li>
                    <a href="#timeline" aria-label="Timeline">Timeline</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="key-findings">Key Findings<a hidden class="anchor" aria-hidden="true" href="#key-findings">#</a></h1>
<ul>
<li>Golden SAML, an attack technique that exploits the SAML single sign-on protocol, was used as a post-breach exploit, compounding the devastating SolarWinds attack of 2020, one of the largest breaches of the 21st century.</li>
<li>The supply chain SolarWinds attack affected thousands of organizations around the world, including the US Government. Attackers deployed malicious code into the company’s Orion IT management and monitoring software.</li>
<li>In the wake of this attack, CISA and cybersecurity experts encouraged organizations with hybrid identity environments to move SAML authentication to a cloud identity system such as Entra ID.</li>
<li>Tomer Nahum and Eric Woodruff have discovered a new application of Golden SAML, one that can be exploited even in organizations that have followed previous security recommendations meant to defend against Golden SAML.</li>
<li>The new attack technique, dubbed Silver SAML, enables the exploitation of SAML to launch attacks from an identity provider like Entra ID against applications configured to use it for authentication, such as Salesforce.</li>
<li>To our knowledge, no attacks using Silver SAML have been reported.</li>
<li>We rate this vulnerability as Moderate, with a potential increase to Severe.</li>
</ul>
<p>Golden SAML is a known attack technique discovered by CyberArk and <a href="https://www.cyberark.com/resources/threat-research-blog/golden-saml-newly-discovered-attack-technique-forges-authentication-to-cloud-apps">published by Shaked Reiner</a>. (Remember Golden SAML attack that compounded the damage from the SolarWinds cyberattack, aka Solorigate?) For years, Golden SAML has been known for its extraction of signing certificates from Active Directory Federation Services (AD FS) and its use of those certificates to forge SAML authentication responses. Today, we present a new application of Golden SAML—in Microsoft Entra ID and without the use of AD FS. <strong>Meet Silver SAML.</strong></p>
<h2 id="what-is-silver-saml">What is Silver SAML?<a hidden class="anchor" aria-hidden="true" href="#what-is-silver-saml">#</a></h2>
<p>Today, many organizations use Entra ID as the identity provider (IdP) for software-as-a-service (SaaS) and line-of-business (LOB) applications. SAML is the primary means of authentication for these applications.</p>
<p>Within Entra ID, Microsoft provides a self-signed certificate for SAML response signing. Alternatively, organizations can choose to use an externally generated certificate. However, that option introduces a security risk.</p>
<p>Any attacker that obtains the private key of an externally generated certificate can forge any SAML response they want and sign that response with the same private key that Entra ID holds. With this type of forged SAML response, the attacker can then access the application-as any user.</p>
<p><strong>The proof of concept discussed in this post focuses on Entra ID. But this attack can take advantage of any IdP that allows the import of externally generated SAML signing certificates</strong>.</p>
<p>For the sake of this proof of concept, we built and published a new tool, called <em><strong>SilverSAMLForger,</strong></em> that can be used to forge signed SAML responses. You can <a href="https://github.com/Semperis/GoldenCamelForger">find SilverSAMLForger on GitHub</a>.</p>
<h2 id="background-saml-golden-saml-and-the-solarwinds-attack">Background: SAML, Golden SAML, and the SolarWinds attack<a hidden class="anchor" aria-hidden="true" href="#background-saml-golden-saml-and-the-solarwinds-attack">#</a></h2>
<p>SAML is a staple of modern authentication. For example, 63 percent of Entra ID Gallery applications rely on SAML for integration. Multi-cloud integrations with Amazon Web Services (AWS), Google Cloud Platform (GCP), and others rely on SAML. And many organizations continue to invest in SAML for SaaS and LOB applications because of the simplicity of its implementation.</p>
<h3 id="golden-saml-and-solorigate">Golden SAML and Solorigate<a hidden class="anchor" aria-hidden="true" href="#golden-saml-and-solorigate">#</a></h3>
<p>As part of the global supply chain attack on SolarWinds (aka Solorigate), Golden SAML was one of the attackers’ more innovative attack vectors.</p>
<p>The attackers gained initial access to SolarWinds by inserting malicious code into the company’s Orion Platform, used for infrastructure monitoring and IT management. Later, the attackers used this foothold to move laterally into the AD FS environment. From there, they stole the private key material used to sign SAML responses.</p>
<p>As a result of this post-breach Golden SAML attack, many organizations prioritized the move of applications to Entra ID for SAML authentication. This change removed the need to manage a complex Tier 0 infrastructure, and SAML signing keys cannot be exported from Entra ID. Even CISA recommends that organizations with hybrid identity environments move SAML authentication to cloud identity systems such as Entra ID.</p>
<h3 id="the-trouble-with-saml-and-signing-certificates">The trouble with SAML and signing certificates<a hidden class="anchor" aria-hidden="true" href="#the-trouble-with-saml-and-signing-certificates">#</a></h3>
<p>Unfortunately, many organizations mismanage signing certificates and weaken SAML security by using externally generated certificates. From our observations, enterprise organizations tend to:</p>
<ul>
<li>Generate self-signed signing certificates on a client system</li>
<li>Generate signing certificates through an enterprise public key infrastructure (PKI), such as Active Directory Certificate Services (AD CS)</li>
<li>Obtain and use signing certificates from an external certificate authority (CA)</li>
</ul>
<p>Adding to the problem, we then see organizations that take these externally generated certificates and:</p>
<ul>
<li>Send certificate PFX files and passwords through insecure channels such as Teams or Slack</li>
<li>Generate certificates on client machines, leaving the certificates available for export in the machines’ local certificate store</li>
<li>Generate certificates on web servers, typically running Microsoft Internet Information Services (IIS), leaving the certificates available for export in the machines’ local certificate store</li>
</ul>
<p>Even for organizations that use services such as Azure Key Vault—a more secure method for secret and certificate management—attack vectors can exist. (We will cover those vectors in the next section.)</p>
<p>Using an externally generated certificate for SAML response signing greatly increases the attack surface of any IdP, including Entra ID. We have observed several common lessons in organizations that generate and manage SAML signing certificates externally, rather than directly within Entra ID.</p>
<ul>
<li>Lack of a chain of trust with self-signed certificates from Entra ID</li>
<li>Inability to leverage certificate revocation with self-signed certificates</li>
<li>Need to apply a defined corporate policy blindly to certificate management (usually based on one or both of the previous reasons)</li>
<li>A subjective feeling that self-signed certificates are “less secure”</li>
</ul>
<p>Additionally, some organizations want to maintain a SAML signing certificate lifetime longer than the Entra ID default. These organizations issue external certificates, not realizing that they can simply issue new certificates from Entra ID and configure those certificates to have a longer lifetime.</p>
<p>Many organizations do not understand the nuances of leveraging certificates for SAML signing; signing certificates are simply swept up into their broader certificate management directives and policies. Although common certificate lifecycle and management practices are important to many types of systems, they do not and should not apply to certificates that are used for SAML signing.</p>
<p>A chain of trust is not relevant in SAML. Most IdPs and Service Provider (SP) applications ignore any chain of trust. Unlike the server/client scenario you see with web browsers, an administrator is effectively an essential part of the chain of trust in SAML configurations. The administrator must configure and specify which signing certificate to trust, specifically in the application.</p>
<p>Nor is certificate revocation a relevant practice with SAML. If a signing certificate is compromised, an administrator must rotate (i.e., replace) that certificate in the SP and IdP. <a href="https://docs.oasis-open.org/security/saml/Post2.0/sstc-metadata-iop.html">OASIS SAML 2.0 Metadata Interoperability Profile Version 1.0</a> specifically indicates to refrain from using revocation lists, Online Certificate Status Protocol (OCSP), or other mechanisms for key validation. Instead, you should have the IdP remove compromised keys from the SAML metadata.</p>
<h3 id="importing-external-certificates">Importing external certificates<a hidden class="anchor" aria-hidden="true" href="#importing-external-certificates">#</a></h3>
<p>As Figure 1 shows, you can configure self-signed certificates on an enterprise application (Okta, in this example) in the Entra admin center via the application’s <strong>Manage</strong> &gt; <strong>Single sign-on</strong> &gt; <strong>SAML</strong> &gt; <strong>SAML Certificates</strong> settings.</p>
<p><img loading="lazy" src="/posts/silversaml/Screenshot_SilverSAML_Fig1_ConfiguringSelfSignedSAML-1024x914.png"></p>
<p><em>Figure 1. Configuring self-signed SAML certificates on a service principal in Entra ID [SSOPage.png]</em></p>
<p>In the <strong>SAML Signing Certificate</strong> pane, you can import your own certificate to sign the SAML response or assertions (Figure 2).</p>
<p><img loading="lazy" src="/posts/silversaml/Screenshot_SilverSAML_Fig2_ImportingSAMLCerts.png"></p>
<p><em>Figure 2. Importing SAML certificates on a service principal in Entra ID</em> [CertificatePage.png]</p>
<h2 id="what-about-azure-key-vault">What about Azure Key Vault?<a hidden class="anchor" aria-hidden="true" href="#what-about-azure-key-vault">#</a></h2>
<p>We need to take a moment to talk about Azure Key Vault: one of the places where self-signed certificates might be stored. We wanted to determine whether an attacker could extract keys from Key Vault. Spoiler: They can. (If your organization does not use Key Vault, feel free to jump to the next section.)</p>
<p>Azure Key Vault is a popular key-management solution provided by Microsoft. Key Vault enables you to securely store and manage secrets, encryption keys, and certificates.</p>
<p>As with most cloud services, Key Vault has two planes that govern access and management: the control plane and the data plane.</p>
<ul>
<li><strong>Control plane.</strong> Roles and permissions assigned to the control plane are associated with administrative tasks and Key Vault configuration settings. Users, groups, or service principals that are assigned control plane permissions can configure access policies, create key vaults, and perform other management tasks. Rights can be granted granularly to an individual vault but are often granted at the resource group, subscription, or management group level.</li>
<li><strong>Data plane.</strong> The data plane relates to the actual data stored in a key vault: secrets, keys, and certificates. Rights assigned on the data plane control which users or service principals can read and write cryptographic material to and from the key vault. These rights include the ability to read certificate private keys, which is a concern if those keys are used for SAML response signing.</li>
</ul>
<p>Key Vault permissions can be granted through role-based access control (RBAC) or Key Vault access policies.</p>
<h3 id="the-rbac-permissions-model">The RBAC permissions model<a hidden class="anchor" aria-hidden="true" href="#the-rbac-permissions-model">#</a></h3>
<p>With the RBAC model (Figure 3), any user that holds one of the following RBAC roles can retrieve a key vault’s certificate.</p>
<ul>
<li><strong>Key Vault Administrator</strong></li>
<li><strong>Key Vault Certificates Officer</strong></li>
<li><strong>Key Vault Data Access Administrator.</strong> This role enables you to manage access by adding or removing role assignments. Therefore, you can assign the Key Vault Administrator or Key Vault Certificates Officer role to any entity.</li>
<li><strong>Key Vault Contributor.</strong> This role does not grant data plane permissions but enables you to update the key vault’s access policy if the access policies permission model is also used.</li>
</ul>
<p><img alt="A screenshot of a computer  Description automatically generated" loading="lazy" src="/posts/silversaml/Screenshot_SilverSAML_Fig3_SpecifyingRolesinKeyVault.png"></p>
<p><em>Figure 3. Specifying roles in Azure Key Vault</em> [KeyVaultIAM.png]</p>
<p>Figure 4 shows an example of the permissions that are granted to the Key Vault Administrator role.</p>
<p><img alt="A screenshot of a computer program  Description automatically generated" loading="lazy" src="/posts/silversaml/Screenshot_SilverSAML_Fig4_KVAPermissions.webp"></p>
<p><em>Figure 4. Key Vault Administrator role permissions</em> [KeyAdminPerms.png]</p>
<p>A person who holds the Key Vault Contributor role, which has no data plane permissions to access the key vault secrets and certificates, can still extract them if access policies are used. This role does have the <strong>Microsoft.KeyVault/*</strong> control plane permission. This permission can be translated to <strong>Microsoft.KeyVault/vaults/accessPolicies/write</strong>, enabling the holder to write Key Vault access policies and extract key vault secrets.</p>
<p>If you can add RBAC permissions at the resource group or subscription level, by gaining control of a resource group owner account or a user account that has the <strong>Role Based Access Control Administrator</strong> RBAC permission or any user with <strong>Microsoft.Authorization/roleAssignments/write</strong> permission, you can add Key Vault permissions. The key vault will then inherit those permissions. As mentioned earlier, some RBAC roles can also directly modify Key Vault access policies.</p>
<p>Key vaults can also be accessed via Automation accounts and Managed Identities that have the required permissions.</p>
<h3 id="the-key-vault-access-policies-permissions-model">The Key Vault access policies permissions model<a hidden class="anchor" aria-hidden="true" href="#the-key-vault-access-policies-permissions-model">#</a></h3>
<p>In this model, you can also grant Key Vault access permissions to a user, service, or group. You can choose between key permissions, secret permissions, and certificate permissions (Figure 5).</p>
<p><img alt="A screenshot of a computer  Description automatically generated" loading="lazy" src="/posts/silversaml/Screenshot_SilverSAML_Fig5_VaultAccessPolicies.png"></p>
<p><em>Figure 5. Key Vault certificate permissions</em> [VaultAccessPolicies.png]</p>
<p>You can add access policies in the Key Vault Access policies pane (Figure 6).</p>
<p><img loading="lazy" src="/posts/silversaml/Screenshot_SilverSAML_Fig6_KeyVaultAccessPolicies.png"></p>
<p><em>Figure 6. Adding Key Vault access policies</em> [KeyVaultAccessPolicies.png]</p>
<p>Any attacker that gains control of any user, service principal, or group that has permission to retrieve the PFX file that is used to sign the SAML assertions or responses for the attacked SP—through either RBAC or Key Vault access policies—can perform a Silver SAML attack on that SP.</p>
<h2 id="saml-and-entra-id">SAML and Entra ID<a hidden class="anchor" aria-hidden="true" href="#saml-and-entra-id">#</a></h2>
<p>SAML, in its current 2.0 version, is almost 20 years old. OASIS published the protocol in March 2005. Since then, many enterprises have adopted SAML for federated authentication and web-based SSO solutions. The protocol’s primary implementation—and the use case within Entra ID—is leveraging the web browser SSO profile.</p>
<p>A typical SAML profile flow has three core components:</p>
<ul>
<li>The service provider (SP), or application; also commonly referred to as the relying party (RP) in the Microsoft ecosystem</li>
<li>The identity provider (IdP), which in our proof of concept is Entra ID</li>
<li>The user agent, typically a client’s (end user’s) web browser</li>
</ul>
<p>Users interact with applications for authentication in various ways, depending on whether the application is configured for or supports SP-initiated or IdP-initiated flows.</p>
<p>In an SP-initiated flow (Figure 7), the following sequence occurs:</p>
<ol>
<li>The user browses to a URL for the application (SP).</li>
<li>The SP generates a SAML request (Figure 8) and redirects the user to Entra ID (IdP).</li>
<li>Entra ID consumes the SAML request.</li>
<li>If the user has not yet authenticated to Entra ID, the user is prompted for authentication.</li>
<li>The user successfully authenticates to Entra ID.</li>
<li>Entra ID generates a SAML response (Figure 9) and redirects the user to the SP.</li>
<li>The SP verifies the SAML response.</li>
<li>The user receives access to the application.</li>
</ol>
<p><img alt="A diagram of a browser  Description automatically generated" loading="lazy" src="/posts/silversaml/Screenshot_SilverSAML_Fig7_SPInitiatedFlow-1920x931.png"></p>
<p><em>Figure 7. SP-initiated flow diagram</em></p>
<p><img alt="A black screen with white text  Description automatically generated" loading="lazy" src="/posts/silversaml/Screenshot_SilverSAML_Fig8_SAMLRequest.webp"></p>
<p><em>Figure 8. Example of a SAML authentication request</em> <strong>[SAMLRequest.png]</strong></p>
<p><img alt="A screenshot of a computer program  Description automatically generated" loading="lazy" src="/posts/silversaml/Screenshot_SilverSAML_Fig9_SAMLResponseExample.png">
<em>Figure 9. Example of a SAML response</em> [SAMLResponseExample.png]</p>
<p>In an IdP-initiated flow (Figure 10), the following sequence occurs:</p>
<ol>
<li>The user browses to myapps.microsoft.com.</li>
<li>If the user has not yet authenticated to Entra ID, the user is prompted for authentication.</li>
<li>The user successfully authenticates to Entra ID.</li>
<li>Entra ID provides a list of applications available to the user in myapps.microsoft.com.</li>
<li>The user selects the target application.</li>
<li>Entra ID generates a SAML response and redirects the user to the SP.</li>
<li>The SP verifies the SAML response.</li>
<li>The user receives access to the application.</li>
</ol>
<p><img alt="A diagram of a browser  Description automatically generated" loading="lazy" src="/posts/silversaml/Screenshot_SilverSAML_Fig10_IDPInitiatedFlow-1920x944.png"></p>
<p><em>Figure 10. IdP-initiated flow diagram</em></p>
<p>The contents of a SAML assertion includes several bits of information about the end user, or subject, in a series of key-value pairs. This information is often referred to as <em>SAML claims</em> and includes information such as:</p>
<ul>
<li><strong>The subject.</strong> The application uses this required component as the user’s unique identifier. In many implementations, the subject is the user’s User Principal Name (UPN) or email address.</li>
<li><strong>Attribute information.</strong> This information might include the user’s given name, surname, email address, and display name. Group membership or roles are often provided so that the application can make authorization decisions about which rights the user should have.</li>
<li><strong>Other authentication contextual information.</strong> This information might include the type of authentication used, the issuer and audience, and timestamp information that indicates the window of validity for the SAML response.</li>
</ul>
<p>How do you ensure that the SAML response, which is handled by the user, has not been tampered with? This is where signing comes into play.</p>
<p>Entra ID supports both SAML response and SAML assertion signing. At a high level, the purpose of both response and assertion signing is to verify that the contents of the response have not been tampered with and that the application can trust the information in the response. The application uses the signature to validate that the response was generated by the IdP, which holds the private key used to sign the response.</p>
<p>This is why theft of the signing private key is a critical issue. With the signing key in hand, a threat actor can forge a copy of a SAML response, performing a Silver SAML attack.</p>
<h2 id="performing-a-silver-saml-attack">Performing a Silver SAML attack<a hidden class="anchor" aria-hidden="true" href="#performing-a-silver-saml-attack">#</a></h2>
<p>To test the theory that the Golden SAML attack technique can be turned against Entra ID—in what we have dubbed a Silver SAML attack—we built the SilverSAMLForger tool. This tool generates a SAML response that duplicates an Entra ID response, signing that response with a provided certificate.</p>
<p>Our Silver SAML proof of concept is built on the premise that an organization is using an externally generated signing certificate, which an attacker has obtained by using one of the previously discussed methods. We look at applying Silver SAML in both SP-initiated flows and IDP-initiated flows, as both are susceptible to attack.</p>
<h3 id="silver-saml-in-an-sp-initiated-flow">Silver SAML in an SP-initiated flow<a hidden class="anchor" aria-hidden="true" href="#silver-saml-in-an-sp-initiated-flow">#</a></h3>
<p>Silver SAML attack using Entra ID as the IdP and Okta as the SP. To launch the attack in an SP-initiated flow, we needed to intercept the SAML request and replace the contents of the SAML response with the forged SAML response that we created (Figure 11). We were able to accomplish these tasks easily by using Burp Suite.</p>
<p><img alt="A diagram of a browser  Description automatically generated" loading="lazy" src="/posts/silversaml/Screenshot_SilverSAML_Fig11_AttackInSPInitiatedFlow-1920x930.png"></p>
<p><em>Figure 11. Silver SAML attack in an SP-initiated flow</em></p>
<p>For this example, we attempted to forge a SAML response for the user <a href="mailto:oktaAdministrator@xd6z7.onmicrosoft.com">oktaAdministrator@xd6z7.onmicrosoft.com</a>. This user is a Super Administrator in Okta. We do not have the user’s password or the user’s MFA connected device (if configured).</p>
<p>First, we needed some attributes in the SAML claims information in accordance with what was set up when the application was registered on the IdP. For example, we need the UPN, surname, firstname, displayName, and objectID. An attacker can easily find these attributes in the Entra admin center or by using the Microsoft Graph API.</p>
<p>We also needed to know the recipient and audience. That information was available in the Entra admin center, in the application’s <strong>Single sign-on</strong> pane (Figure 12).</p>
<p><img alt="A screenshot of a computer  Description automatically generated" loading="lazy" src="/posts/silversaml/Screenshot_SilverSAML_Fig12_SSOSetting.png"></p>
<p><em>Figure 12. Identifying the signing recipient and audience</em> [SSOSettings.png]</p>
<p>Running SilverSAMLForger.exe with the required parameters output a base64 and URL encoded string (Figure 13). We can now copy this forged SAML response. .</p>
<p><img loading="lazy" src="/posts/silversaml/Screenshot_SilverSAML_Fig13_SAMLGeneratedResponse.png"></p>
<p><em>Figure 13. SAML generated response</em> [SAMLGeneratedResponse.png]</p>
<p>We copied the generated SAML response to the intercepted HTTPS request (Figure 14) and modified the response to the forged one (Figure 15).</p>
<p><img loading="lazy" src="/posts/silversaml/Screenshot_SilverSAML_Fig14_BurpRequestURL.png"></p>
<p><em>Figure 14. Copying the SAML response to the intercepted HTTPS request</em> [BurpRequestURL.png]</p>
<p><img loading="lazy" src="/posts/silversaml/Screenshot_SilverSAML_Fig15_BurpIntercept.png"></p>
<p><em>Figure 15. Changing the SAML response</em> [BurpIntercept.png]</p>
<p>After sending the forged response, we can stop intercepting as we are now logged in as the targeted user (Figure 16). <img loading="lazy" src="/posts/silversaml/Screenshot_SilverSAML_Fig16_SuccessSignInOktaAdmin.webp"></p>
<p><em>Figure 16. Successful sign-in as the target user</em> [SuccessfulSignInOktaAdmin.png]</p>
<h3 id="silver-saml-attack-in-an-idp-initiated-flow">Silver SAML attack in an IdP-initiated flow<a hidden class="anchor" aria-hidden="true" href="#silver-saml-attack-in-an-idp-initiated-flow">#</a></h3>
<p>IdP-initiated flows come with a much greater risk to the organization because no interaction is required with Entra ID. If the application supports IdP-initiated flows, <strong>you can directly post a SAML response to the application</strong> (Figure 17).</p>
<p><img loading="lazy" src="/posts/silversaml/Screenshot_SilverSAML_Fig17_AttackInIDPInitiatedFlow.png"></p>
<p><em>Figure 17. Silver SAML attack in an IdP-initiated flow</em></p>
<p>For this part of the proof of concept, we tried to perform an IdP-initiated attack against Salesforce.</p>
<p>We targeted the user Patti Fernandez, forging a response with her UPN as the subject. The response (Figure 17) was signed using the same SAML signing certificate that was configured for Salesforce in Entra ID.</p>
<p><img alt="A screenshot of a computer screen  Description automatically generated" loading="lazy" src="/posts/silversaml/Screenshot_SilverSAML_Fig18_SalesForce.png"></p>
<p><em>Figure 18. SAML response</em> [SalesForceForging.png] (The pictures looks a bit different from the one here cause we updated the pic)</p>
<p>Decoding this response, you can see that it’s a forged response for Patti (Figure 18).</p>
<p><img loading="lazy" src="/posts/silversaml/Screenshot_SilverSAML_Fig19_Attack-in-SP-initiated-flow.png"></p>
<p><em>Figure 19. Silver SAML attack in an SP-initiated flow</em></p>
<p>In Burp Suite, we used Repeater to directly post the forged SAML response to our instance of Salesforce (Figure 19).<img alt="A screenshot of a computer  Description automatically generated" loading="lazy" src="/posts/silversaml/Screenshot_SilverSAML_Fig20_Posting-forged-SAML-response-1920x1128.webp"></p>
<p><em>Figure 20. Posting a forged SAML response</em></p>
<p>Opening the response in a browser, we verified that we are logged into Salesforce as Patti, <strong>without any interaction with Entra ID</strong> (Figure 20).</p>
<p><img alt="A screenshot of a computer  Description automatically generated" loading="lazy" src="/posts/silversaml/Screenshot_SilverSAML_Fig21_Logging-onto-SF-with-forged-SAML.webp"></p>
<p><em>Figure 21. Logging on to Salesforce with a forged SAML response</em></p>
<h2 id="defending-against-silver-saml-attacks">Defending against Silver SAML attacks<a hidden class="anchor" aria-hidden="true" href="#defending-against-silver-saml-attacks">#</a></h2>
<p>To safeguard effectively against Silver SAML attacks in Entra ID, your organization should use <em>only</em> Entra ID self-signed certificates for SAML signing purposes.</p>
<p>SAML signing certificates are stored in the service principal for a SAML application in Entra ID. You can use the Graph API to view the information that is exposed about the signing key. Simply call a GET request to the following URI: <a href="https://graph.microsoft.com/beta/servicePrincipals/%7Bserviceprincipalobjectid%7D">https://graph.microsoft.com/beta/servicePrincipals/{serviceprincipalobjectid}</a></p>
<p>Figure 22 shows an example of the exposed information. Note that the private key material is not exportable, preventing attackers from gathering the information they need to launch a Silver SAML attack.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;customKeyIdentifier&#34;</span><span class="err">:</span> <span class="s2">&#34;Gk//vUF/JYC58HRyyuGMM5ydmOuJVUL74R6OszKQn6w=&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;endDateTime&#34;</span><span class="err">:</span> <span class="s2">&#34;2026-08-08T14:19:35Z&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;keyId&#34;</span><span class="err">:</span> <span class="s2">&#34;66ad0fe4-111d-45da-924c-545913d77be9&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;startDateTime&#34;</span><span class="err">:</span> <span class="s2">&#34;2023-08-08T14:19:36Z&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;type&#34;</span><span class="err">:</span> <span class="s2">&#34;AsymmetricX509Cert&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;usage&#34;</span><span class="err">:</span> <span class="s2">&#34;Sign&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;key&#34;</span><span class="err">:</span> <span class="n">null</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;displayName&#34;</span><span class="err">:</span> <span class="s2">&#34;CN=Microsoft Azure Federated SSO Certificate&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;hasExtendedValue&#34;</span><span class="err">:</span> <span class="n">null</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><em>Figure 22. Exposed signing key information</em></p>
<p>Global Administrators, Application Administrators, Cloud Application Administrators, and any user who is delegated application ownership can modify which signing keys are available, and can import an external signing key. Although the associated application will need to be updated, organizations should limit who has ownership over applications in Entra ID. At the very least, monitor for changes to SAML signing keys, especially if the key is not near its expiration.</p>
<p>Organizations can audit existing service principals that are configured for SAML and check the displayName. If the used certificate is generated by Microsoft, the certificate will contain the value <strong>CN=Microsoft Azure Federated SSO Certificate</strong>. However, nothing prevents an attacker from importing an external certificate that has the same subject name.</p>
<p>Organizations can also monitor Entra ID audit logs for changes to <strong>PreferredTokenSigningKeyThumbprint</strong> under <strong>ApplicationManagement</strong>. You will need to correlate those events to <strong>Add service principal credential</strong> events that relate to the service principal. The rotation of expired certificates is a common process, so you will need to determine whether the audit events are legitimate. Implementing change control processes to document the rotation can help to minimize confusion during rotation events.</p>
<p>If an application supports both SAML and OpenID Connect (OIDC) for authentication, you might consider changing the integration with Entra ID to use OIDC, mitigating this attack. The complexity of changing from SAML to OIDC largely depends on how the application developer has implemented the standards.</p>
<h2 id="on-the-app-side-application-developers-can-protect-against-attacks-in-a-few-ways-your-options-will-depend-on-the-methods-and-libraries-used-in-your-saml-implementation">On the app side, application developers can protect against attacks in a few ways. (Your options will depend on the methods and libraries used in your SAML implementation.)<a hidden class="anchor" aria-hidden="true" href="#on-the-app-side-application-developers-can-protect-against-attacks-in-a-few-ways-your-options-will-depend-on-the-methods-and-libraries-used-in-your-saml-implementation">#</a></h2>
<ul>
<li>Require SP-initiated flows, which protect against IdP-initiated flows—the most dangerous types of attacks.</li>
<li>For SP-initiated flows, follow the SAML specification and ensure that responses contain an <strong>InResponseTo</strong> value that correlates to an associated SAML request.</li>
<li>Observe the time in which the application receives a SAML response. The IdP indicates a window of validity in the response, but application developers can introduce further logical limitations to the acceptable window for receiving a response in SP-initiated flows.</li>
<li>Offer the choice of using OIDC, instead of SAML, for integration.</li>
</ul>
<h2 id="dont-let-silver-saml-take-you-by-surprise">Don’t let Silver SAML take you by surprise<a hidden class="anchor" aria-hidden="true" href="#dont-let-silver-saml-take-you-by-surprise">#</a></h2>
<p>Like the Golden SAML attack, Silver SAML attacks have the potential to be mild—or devastating. As the adoption of cloud and hybrid identity environments continues to grow, we expect to see more threats aimed at IdPs like Entra ID. We encourage organizations to take decisive steps now to close gaps and vulnerabilities in these environments.</p>
<h2 id="disclosure">Disclosure<a hidden class="anchor" aria-hidden="true" href="#disclosure">#</a></h2>
<p>This issue was reported via the Microsoft Security Response Center (MSRC) on January 2, 2024. Microsoft replied on February 26, 2024: “After careful investigation, this case has been assessed as by-design and does not meet MSRC’s bar for immediate servicing. However, we have shared the report with the team responsible for maintaining the product or service. They will take appropriate action as needed to help keep customers protected.”</p>
<h2 id="timeline">Timeline<a hidden class="anchor" aria-hidden="true" href="#timeline">#</a></h2>
<p>January 2, 2024: MSRC case created</p>
<p>January 3, 2024: Case status changed to Review/Reprod</p>
<p>February 17, 2024: MSRC review of research article</p>
<p>February 26, 2024: MSRC response received</p>
<p>February 29, 2024: Public disclosure</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/posts/whatisentra/">
    <span class="title">« Prev</span>
    <br>
    <span>What is Entra Goat?</span>
  </a>
  <a class="next" href="http://localhost:1313/posts/softmatching/">
    <span class="title">Next »</span>
    <br>
    <span>Soft-Matching Abuse in Azure AD</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Meet Silver SAML: Golden SAML in the Cloud on x"
            href="https://x.com/intent/tweet/?text=Meet%20Silver%20SAML%3a%20Golden%20SAML%20in%20the%20Cloud&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fsilversaml%2f&amp;hashtags=">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Meet Silver SAML: Golden SAML in the Cloud on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fsilversaml%2f&amp;title=Meet%20Silver%20SAML%3a%20Golden%20SAML%20in%20the%20Cloud&amp;summary=Meet%20Silver%20SAML%3a%20Golden%20SAML%20in%20the%20Cloud&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2fsilversaml%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Meet Silver SAML: Golden SAML in the Cloud on reddit"
            href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2fsilversaml%2f&title=Meet%20Silver%20SAML%3a%20Golden%20SAML%20in%20the%20Cloud">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Meet Silver SAML: Golden SAML in the Cloud on facebook"
            href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2fsilversaml%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Meet Silver SAML: Golden SAML in the Cloud on whatsapp"
            href="https://api.whatsapp.com/send?text=Meet%20Silver%20SAML%3a%20Golden%20SAML%20in%20the%20Cloud%20-%20http%3a%2f%2flocalhost%3a1313%2fposts%2fsilversaml%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Meet Silver SAML: Golden SAML in the Cloud on telegram"
            href="https://telegram.me/share/url?text=Meet%20Silver%20SAML%3a%20Golden%20SAML%20in%20the%20Cloud&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fsilversaml%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Meet Silver SAML: Golden SAML in the Cloud on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=Meet%20Silver%20SAML%3a%20Golden%20SAML%20in%20the%20Cloud&u=http%3a%2f%2flocalhost%3a1313%2fposts%2fsilversaml%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">TomerN</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
