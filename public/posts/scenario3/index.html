<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>EntraGoat Scenario 3: Exploiting Group Ownership in Entra ID | TomerN</title>
<meta name="keywords" content="">
<meta name="description" content="Group MemberShipwreck – Sailed into Admin Waters
EntraGoat Scenario 3 demonstrates how legitimate Entra ID administrative features - group ownership, role-assignable groups, and service principal management can be chained into an unintended privilege escalation path from a low-privileged user to Global Administrator.
The attacker begins with a compromised IT support account that owns several groups, including one that is role-assignable with the Application Administrator role. By adding themselves to this group, the attacker inherits the role and gets broad control over applications and service principals across the tenant.">
<meta name="author" content="Tomer Nahum, Jonathan Elkabas">
<link rel="canonical" href="http://localhost:1313/posts/scenario3/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.a59eb1fe3d954acf19e87bac091377a5f9194d1458a08ac191d3da5c9eb2b3f2.css" integrity="sha256-pZ6x/j2VSs8Z6HusCRN3pfkZTRRYoIrBkdPaXJ6ys/I=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/scenario3/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><html>

<body>

</body>
</html><meta property="og:url" content="http://localhost:1313/posts/scenario3/">
  <meta property="og:site_name" content="TomerN">
  <meta property="og:title" content="EntraGoat Scenario 3: Exploiting Group Ownership in Entra ID">
  <meta property="og:description" content="Group MemberShipwreck – Sailed into Admin Waters EntraGoat Scenario 3 demonstrates how legitimate Entra ID administrative features - group ownership, role-assignable groups, and service principal management can be chained into an unintended privilege escalation path from a low-privileged user to Global Administrator.
The attacker begins with a compromised IT support account that owns several groups, including one that is role-assignable with the Application Administrator role. By adding themselves to this group, the attacker inherits the role and gets broad control over applications and service principals across the tenant.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-11-09T00:17:27+03:00">
    <meta property="article:modified_time" content="2025-11-09T00:17:27+03:00">
      <meta property="og:image" content="http://localhost:1313/images/tomer.jpg">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://localhost:1313/images/tomer.jpg">
<meta name="twitter:title" content="EntraGoat Scenario 3: Exploiting Group Ownership in Entra ID">
<meta name="twitter:description" content="Group MemberShipwreck – Sailed into Admin Waters
EntraGoat Scenario 3 demonstrates how legitimate Entra ID administrative features - group ownership, role-assignable groups, and service principal management can be chained into an unintended privilege escalation path from a low-privileged user to Global Administrator.
The attacker begins with a compromised IT support account that owns several groups, including one that is role-assignable with the Application Administrator role. By adding themselves to this group, the attacker inherits the role and gets broad control over applications and service principals across the tenant.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "EntraGoat Scenario 3: Exploiting Group Ownership in Entra ID",
      "item": "http://localhost:1313/posts/scenario3/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "EntraGoat Scenario 3: Exploiting Group Ownership in Entra ID",
  "name": "EntraGoat Scenario 3: Exploiting Group Ownership in Entra ID",
  "description": "Group MemberShipwreck – Sailed into Admin Waters EntraGoat Scenario 3 demonstrates how legitimate Entra ID administrative features - group ownership, role-assignable groups, and service principal management can be chained into an unintended privilege escalation path from a low-privileged user to Global Administrator.\nThe attacker begins with a compromised IT support account that owns several groups, including one that is role-assignable with the Application Administrator role. By adding themselves to this group, the attacker inherits the role and gets broad control over applications and service principals across the tenant.\n",
  "keywords": [
    
  ],
  "articleBody": "Group MemberShipwreck – Sailed into Admin Waters EntraGoat Scenario 3 demonstrates how legitimate Entra ID administrative features - group ownership, role-assignable groups, and service principal management can be chained into an unintended privilege escalation path from a low-privileged user to Global Administrator.\nThe attacker begins with a compromised IT support account that owns several groups, including one that is role-assignable with the Application Administrator role. By adding themselves to this group, the attacker inherits the role and gets broad control over applications and service principals across the tenant.\nFrom there, by identifying a high-value service principal that is a member of another role-assignable group holding the Privileged Authentication Administrator role, the attacker adds a client secret to it, authenticates as the privileged service principal, and resets the Global Administrator’s password.\nThis scenario highlights how individually legitimate Entra ID features, when combined with misconfigured group ownership, can cascade into a privilege escalation chain that elevates a low-level account into a tenant-wide threat.\nAttack path overview Initial foothold: The attacker authenticates as Michael Chen, a compromised IT Support Specialist user who, according to the scenario’s description, “manages a few security groups”. Enumeration: The attacker discovers ownership of six groups, including one role-assignable group called IT Application Managers that holds the Application Administrator role. Privilege escalation: The attacker adds themselves to the security group to inherit the privileged role. Service principal targeting: With the Application Administrator directory role, the attacker identifies the Identity Management Portal service principal as a member of a group with the Privileged Authentication Administrator role and adds a client secret to it. Pivoting: The attacker authenticates via the client credential grant OAuth2 flow as the compromised service principal with the newly added secret. Account compromise: Using the service principal’s inherent privileges, the attacker resets the Global Administrator’s password, authenticates as the GA, and retrieves the scenario flag. Attack flow Why This Attack Works? This scenario chains together several legitimate Entra ID features that, when misconfigured, create an escalation path:\nGroup ownership: Entra ID’s group ownership model grants extensive control over membership and properties. While intended to delegate administrative tasks, it becomes risky when applied to role-assignable groups or granted to inappropriate users since an owner can directly add themselves (or any controlled account) to the group and inherit its assigned roles. Role-assignable groups: Role-assignable security groups allow administrators to assign directory roles to groups rather than individual users, simplifying role management at scale by making any member of the group automatically receive the assigned roles. When combined with group ownership permissions, this creates a privilege escalation pathway where group owners can effectively grant themselves the roles assigned to groups they control. Service principal group membership: SPs, like users, can be members of security groups and inherit any roles assigned to those groups. This design enables administrators to manage application permissions through group membership rather than individual role assignments. However, SPs present unique attack surfaces that regular Entra ID users don’t: They can be compromised through ownership relationships (as seen in Scenario 1). They are subject to application-management controls – identities with the built-in Application Administrator or Cloud Application Administrator roles, custom roles that include the microsoft.directory/applications/credentials/update or microsoft.directory/servicePrincipals/credentials/update actions, or service principals with the Application.ReadWrite.All permission can add or modify SP credentials. They can be managed programmatically through APIs and automation workflows. Unlike user identities, they cannot be assigned as PIM-eligible; they can only have active role assignments (which may be time-bound). When an SP is in a role-assignable group, its access bypasses PIM’s just-in-time activation controls, providing always-active role membership during the assignment window. They can authenticate in an app-only context (OAuth2 client-credentials) using a client secret or certificate, which bypasses user-centric controls such as interactive MFA and interactive Conditional Access requirements. These additional mechanisms create more potential vectors for gaining unauthorized access to any privileged SP that holds privileged group memberships.\nApplication Administrator scope: The role provides broad control over application registrations and SPs, including the ability to add authentication credentials (secrets and certificates) to applications in the tenant, creating opportunities for attackers to backdoor high-value SPs that aren’t configured with app instance lock. Each of these Entra ID features is legitimate and necessary for administrative delegation, but in combination, they create unintended privilege escalation paths that can elevate a low-privileged identity all the way to Global Administrator.\nHow to Detect and Defend Against Group Ownership Misuse\nMonitoring group ownership is a fundamental security requirement in any Entra ID environment. Owners can manage membership, change group properties, and indirectly control any directory roles assigned to their groups. Without clear visibility into ownership relationships and role assignments, privilege escalation paths through role-assignable groups can remain concealed from both defenders and auditors.\nDefenders should monitor and correlate:\nWhich role-assignable groups exist in the tenant? What directory roles are assigned to these groups? Who owns them and what business justification exists for that ownership? Do any unprivileged users own groups with privileged role assignments? Which service principals are members of role-assignable groups? Are there unused or orphaned groups that can be decommissioned? Semperis solutions help close gaps in understanding these questions with multiple layers of defense starting with indicators of exposure (IOEs) and indicators of compromise (IOCs).\nThese indicators automatically detect and alert on dangerous defaults and misconfigurations - such as role-assignable groups with inappropriate owners, service principals with dangerous permissions, and weak group governance baselines that enable privilege escalation through group membership manipulation.\nScenario deep dive - step-by-step solution walkthrough You can find the full walkthrough and accompanying commands in the EntraGoat GitHub repository under solutions/EntraGoat-Scenario3-Solution.ps1.\nStep 1: Initial foothold We begin Scenario 3 with access to a compromised low-privileged user named Michael Chen, an IT support specialist. The background story tells us Michael owns several security groups - a misconfiguration that sets the stage for escalation.\nWe authenticate with his credentials using Connect-MgGraph and then run Get-MgContext to confirm our current security context.\nStep 2: Enumeration Next, since the hint points us in this direction, we enumerate all groups owned by the current user:\nWe discover that he owns 6 groups in total. To assess privilege escalation potential, we check whether any of them are role-assignable and actually have roles assigned:\nOne group immediately stands out: IT Application Managers, which holds the Application Administrator role. This role is powerful as it grants full control over all application registrations and service principals in the tenant, including the ability to add secrets or certificates to any 3rd party applications (in case they aren’t configured with app instance lock). Then, the attacker can use the SP identity to authenticate to the tenant via the OAuth 2.0 client credential grant flow, operating in an app-only context that bypasses user-centric protections.\n__________\nNote:\nThe enumeration steps above can be wrapped into dedicated helper functions (for example, Get-GroupsOwnedBy for ownership and Get-GroupRoles for assigned roles) to make the process more interactive and verbose, similar to how open-source tools present results. The implementation:\nHere’s how the flashy output looks like when we run this enumeration function with the current user’s ID:\nWhile this can be helpful in large environments, Microsoft Graph also provides a far more efficient cmdlet: Get-MgUserOwnedObject\nGet-MgUserOwnedObject enumerates all directory objects owned by a user, eliminating the need to query each object type (groups, devices, apps and SPs) individually, unlike how we intentionally implemented. The command can be tweaked a bit with Sonnet to get a nicer output:\nThe command Get-MgUserOwnedObject typically makes one API request to https://graph.microsoft.com/v1.0/users/{userId}/ownedObjects (maybe 1-2 more in case of pagination), with the rest handled by local PowerShell logic to process, extract, and format the response.\nBy comparison, the Get-GroupsOwnedBy function we created, which might be more interactive and user-friendly, makes 100-1000x API requests even though it only checks for one type of owned object.\nWhen selecting enumeration tools, it’s always a good idea to prioritize efficiency - Fewer API calls mean fewer logs and a smaller detection footprint. There are many awesome (and some less-awesome) open-source tools for enumerating Entra ID environments. The key point is that although tools can be useful shortcuts, they should never be used as black boxes. If you can read the source code, do it. Take the time to understand how the queries are constructed, what API endpoints are being hit, and what data is actually being returned. Tools are only as effective as the operator’s understanding of their methods and limitations (:\n__________\nStep 3: Building the attack chain Owning a group with Application Administrator rights presents significant privilege escalation potential, because once we add ourselves as a member, we can manage (== add a client secret to*) any* service principal in the tenant, which opens multiple routes to tenant compromise. But adding ourselves right now would be noisy and unnecessary from an OPSEC perspective. First, we should confirm there is a privileged SP we can leverage to reach the next chain on the attack – the GA role. Time to hunt for high-value SPs.\n__________\n**Note:**For this walkthrough, we’ll keep the spotlight on enumerating SPs with privileged roles that can reset the GA’s password with only a few steps:\nPrivileged Role Administrator (PRA) Privileged Authentication Administrator (PAA) Global Administrator (GA) That said, in a real tenant you wouldn’t want to stop there. It’s just as important to enumerate SPs with other roles and with powerful app permissions, as those can open up equally dangerous escalation paths, as seen in Scenario 2.\n__________\nWe’ll start by using the function Get-MgRoleManagementDirectoryRoleAssignment to check if any SPs are directly assigned privileged roles:\nResult? Nothing. Not a single service principal is directly holding GA, PRA or PAA in my tenant.\nBut that’s not the full set of SPs that might have privileged roles assigned. Entra ID allows role-assignable groups, and just like users, SPs can be members of those groups. If a group has GA, PRA or PAA, then any SP inside it inherits those privileges. This is an often-overlooked escalation vector.\nSo, next, we enumerate all groups that are role-assignable and check which ones have the roles assigned (it’s not the most aesthetic code, but it will do the job):\nNow that we have a list of privileged groups, we need to inspect their members. Since the function Get-MgGroupMember operates on v1.0, it doesn’t show SP memberships. To solve that, we’ll wrap a direct call to the /beta endpoint in a helper function:\nNow we can use it to filter for SP membership in the privileged groups:\nNow things get interesting – we discovered potential SPs with privileged roles. Depending on your environment, you may have many more.\nWe can simply pick the first one ($targetSPs[0]), but for the sake of consistency (and so every player has the same path without risking tenant stability), we’ll zero in on the Identity Management Portal. That one is part of the setup script and won’t break anything in case of a change in functionality (fingers crossed).\nAt this stage, we’ve mapped out the full attack chain. Here’s how we’ll move from the current low-priv user all the way to Global Admin:\nAdd ourselves to the IT Application Managers group to inherit the Application Administrator role. Use that role to add a client secret to the Identity Management Portal service principal. Authenticate as that service principal. Use its inherited PAA privileges to reset the Global Admin’s password. Log in as the Global Admin with the new password. Retrieve the flag to prove compromise. Step 4: Executing the attack path First, we add ourselves as members to the IT Application Managers group:\nSince tokens don’t update automatically, we can disconnect and reauthenticate to pull a fresh access token with the new assigned role. As discussed in Scenario 2, this step is not a must, as most Entra ID endpoints usuallyevaluate role assignments dynamically.\nWe can use the parse-JWTToken cmdlet by BARK to see the added app admin role (wids field within the JWT token) assigned to the user.\nWith Application Administrator rights at our hands, we can add backdoor access to the Identity Management Portal like we did in Scenario 1:\nThat gives us persistent SP access, independent of any user account. We can use it to authenticate as the SP to Entra ID:\nThe next step is to find the target GA user and reset its password:\nFinally, we can authenticate as the GA and retrieve the flag. We’ll use Get-MSGraphTokenWithUsernamePassword to authenticate from the CLI (just like in scenario 2), but you can also set a TAP (like in scenario 1) and log interactively from the Azure portal or the Entra ID admin center.\nScenario 3 completed!\nStep 5: Cleanup Don’t forget to run the cleanup script to revert the tenant environment back to its original state:\nConclusion Scenario 3 reveals how seemingly minor misconfigurations in group ownership can cascade into full tenant compromise. The attack chain (from low-privileged user to Global Administrator) required no sophisticated techniques, just an understanding of Entra ID’s delegation model, how role inheritance works, and the control plane of service principal identities.\nThe key takeaway: group ownership is administrative delegation in disguise**. When users own role-assignable groups, they effectively control any roles assigned to those groups.** Service principals amplify this risk because they can be compromised through multiple pathways beyond traditional credential theft - ownership relationships, application management roles, and programmatic access.\nThe scenario shows that in modern cloud identity environments, privilege escalation paths are rarely linear. They weave through ownership relationships, group memberships, and service principal identities in ways that require defenders to think systematically about identity relationships rather than individual permissions. The low-privileged IT support specialist didn’t need to break anything - the escalation path was built into the tenant’s configuration from the get-go.\nEndnote\nhttps://github.com/BloodHoundAD/BARK Disclaimer\nThis content is provided for educational and informational purposes only. It is intended to promote awareness and responsible remediation of security vulnerabilities that may exist on systems you own or are authorized to test. Unauthorized use of this information for malicious purposes, exploitation, or unlawful access is strictly prohibited. We do not endorse or condone any illegal activity and disclaims any liability arising from misuse of the material. Additionally, We do not guarantee the accuracy or completeness of the content and assumes no liability for any damages resulting from its use.\n",
  "wordCount" : "2379",
  "inLanguage": "en",
  "image": "http://localhost:1313/images/tomer.jpg","datePublished": "2025-11-09T00:17:27+03:00",
  "dateModified": "2025-11-09T00:17:27+03:00",
  "author":[{
    "@type": "Person",
    "name": "Tomer Nahum"
  }, {
    "@type": "Person",
    "name": "Jonathan Elkabas"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/scenario3/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "TomerN",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="TomerN (Alt + H)">TomerN</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/opensourceprojects/" title="Open Source Projects">
                    <span>Open Source Projects</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      EntraGoat Scenario 3: Exploiting Group Ownership in Entra ID
    </h1>
    <div class="post-meta"><span title='2025-11-09 00:17:27 +0300 +0300'>November 9, 2025</span>&nbsp;·&nbsp;Tomer Nahum, Jonathan Elkabas

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#group-membershipwreck--sailed-into-admin-waters" aria-label="Group MemberShipwreck – Sailed into Admin Waters">Group MemberShipwreck – Sailed into Admin Waters</a><ul>
                        
                <li>
                    <a href="#attack-path-overview" aria-label="Attack path overview">Attack path overview</a></li>
                <li>
                    <a href="#attack-flow" aria-label="Attack flow">Attack flow</a></li>
                <li>
                    <a href="#why-this-attack-works" aria-label="Why This Attack Works?">Why This Attack Works?</a></li></ul>
                </li>
                <li>
                    <a href="#scenario-deep-dive---step-by-step-solution-walkthrough" aria-label="Scenario deep dive - step-by-step solution walkthrough">Scenario deep dive - step-by-step solution walkthrough</a><ul>
                        
                <li>
                    <a href="#step-1-initial-foothold" aria-label="Step 1: Initial foothold">Step 1: Initial foothold</a></li>
                <li>
                    <a href="#step-2-enumeration" aria-label="Step 2: Enumeration">Step 2: Enumeration</a></li>
                <li>
                    <a href="#step-3-building-the-attack-chain" aria-label="Step 3: Building the attack chain">Step 3: Building the attack chain</a></li>
                <li>
                    <a href="#step-4-executing-the-attack-path" aria-label="Step 4: Executing the attack path">Step 4: Executing the attack path</a></li>
                <li>
                    <a href="#step-5-cleanup" aria-label="Step 5: Cleanup">Step 5: Cleanup</a></li></ul>
                </li>
                <li>
                    <a href="#conclusion" aria-label="Conclusion">Conclusion</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="group-membershipwreck--sailed-into-admin-waters">Group MemberShipwreck – Sailed into Admin Waters<a hidden class="anchor" aria-hidden="true" href="#group-membershipwreck--sailed-into-admin-waters">#</a></h2>
<p>EntraGoat Scenario 3 demonstrates how legitimate Entra ID administrative features - group ownership, role-assignable groups, and service principal management can be chained into an unintended privilege escalation path from a low-privileged user to Global Administrator.</p>
<p>The attacker begins with a compromised IT support account that owns several groups, including one that is role-assignable with the <strong>Application Administrator</strong> role. By adding themselves to this group, the attacker inherits the role and gets broad control over applications and service principals across the tenant.</p>
<p>From there, by identifying a high-value service principal that is a member of another role-assignable group holding the <strong>Privileged Authentication Administrator</strong> role, the attacker adds a client secret to it, authenticates as the privileged service principal, and resets the Global Administrator&rsquo;s password.</p>
<p>This scenario highlights how individually legitimate Entra ID features, when combined with misconfigured group ownership, can cascade into a privilege escalation chain that elevates a low-level account into a tenant-wide threat.</p>
<h3 id="attack-path-overview">Attack path overview<a hidden class="anchor" aria-hidden="true" href="#attack-path-overview">#</a></h3>
<ol>
<li><strong>Initial foothold</strong>: The attacker authenticates as Michael Chen, a compromised IT Support Specialist user who, according to the scenario’s description, “manages a few security groups”.</li>
<li><strong>Enumeration</strong>: The attacker discovers ownership of six groups, including one role-assignable group called IT Application Managers that holds the Application Administrator role.</li>
<li><strong>Privilege escalation</strong>: The attacker adds themselves to the security group to inherit the privileged role.</li>
<li><strong>Service principal targeting</strong>: With the Application Administrator directory role, the attacker identifies the Identity Management Portal service principal as a member of a group with the Privileged Authentication Administrator role and adds a client secret to it.</li>
<li><strong>Pivoting:</strong> The attacker authenticates via the client credential grant OAuth2 flow as the compromised service principal with the newly added secret.</li>
<li><strong>Account compromise</strong>: Using the service principal’s inherent privileges, the attacker resets the Global Administrator’s password, authenticates as the GA, and retrieves the scenario flag.</li>
</ol>
<h3 id="attack-flow">Attack flow<a hidden class="anchor" aria-hidden="true" href="#attack-flow">#</a></h3>
<p><img alt="A computer screen shot of a diagram  AI-generated content may be incorrect." loading="lazy" src="/posts/scenario3/Picture1.png"></p>
<h3 id="why-this-attack-works">Why This Attack Works?<a hidden class="anchor" aria-hidden="true" href="#why-this-attack-works">#</a></h3>
<p>This scenario chains together several legitimate Entra ID features that, when misconfigured, create an escalation path:</p>
<ul>
<li><strong>Group ownership</strong>: Entra ID’s group ownership model grants extensive control over membership and properties. While intended to delegate administrative tasks, it becomes risky when applied to role-assignable groups or granted to inappropriate users since an owner can directly add themselves (or any controlled account) to the group and inherit its assigned roles.</li>
<li><strong>Role-assignable groups</strong>: Role-assignable security groups allow administrators to assign directory roles to groups rather than individual users, simplifying role management at scale by making any member of the group automatically receive the assigned roles. When combined with group ownership permissions, this creates a privilege escalation pathway where group owners can effectively grant themselves the roles assigned to groups they control.</li>
<li><strong>Service principal group membership</strong>: SPs, like users, can be members of security groups and inherit any roles assigned to those groups. This design enables administrators to manage application permissions through group membership rather than individual role assignments. However, <strong>SPs present unique attack surfaces that regular Entra ID users don&rsquo;t</strong>:
<ul>
<li>They can be compromised through ownership relationships (as seen in Scenario 1).</li>
<li>They are subject to application-management controls – identities with the built-in Application Administrator or Cloud Application Administrator roles, custom roles that include the microsoft.directory/applications/credentials/update or microsoft.directory/servicePrincipals/credentials/update actions, or service principals with the Application.ReadWrite.All permission can add or modify SP credentials.</li>
<li>They can be managed programmatically through APIs and automation workflows.</li>
<li>Unlike user identities, they cannot be assigned as PIM-eligible; they can only have active role assignments (which may be time-bound). When an SP is in a role-assignable group, its access bypasses PIM’s just-in-time activation controls, providing always-active role membership during the assignment window.</li>
<li>They can authenticate in an app-only context (OAuth2 client-credentials) using a client secret or certificate, which bypasses user-centric controls such as interactive MFA and interactive Conditional Access requirements.</li>
</ul>
</li>
</ul>
<p>These additional mechanisms create more potential vectors for gaining unauthorized access to any privileged SP that holds privileged group memberships.</p>
<ul>
<li><strong>Application Administrator scope</strong>: The role provides broad control over application registrations and SPs, including the ability to add authentication credentials (secrets and certificates) to applications in the tenant, creating opportunities for attackers to backdoor high-value SPs that aren’t configured with app instance lock.</li>
</ul>
<p>Each of these Entra ID features is legitimate and necessary for administrative delegation, but in combination, they create unintended privilege escalation paths that can elevate a low-privileged identity all the way to Global Administrator.</p>
<p>How to Detect and Defend Against Group Ownership Misuse</p>
<p><strong>Monitoring group ownership is a fundamental security requirement in any Entra ID environment.</strong> Owners can manage membership, change group properties, and indirectly control any directory roles assigned to their groups. Without clear visibility into ownership relationships and role assignments, privilege escalation paths through role-assignable groups can remain concealed from both defenders and auditors.</p>
<p>Defenders should monitor and correlate:</p>
<ul>
<li>Which role-assignable groups exist in the tenant?</li>
<li>What directory roles are assigned to these groups?</li>
<li>Who owns them and what business justification exists for that ownership?</li>
<li>Do any unprivileged users own groups with privileged role assignments?</li>
<li>Which service principals are members of role-assignable groups?</li>
<li>Are there unused or orphaned groups that can be decommissioned?</li>
</ul>
<p>Semperis solutions help close gaps in understanding these questions with multiple layers of defense starting with indicators of exposure (IOEs) and indicators of compromise (IOCs).</p>
<p>These indicators automatically detect and alert on dangerous defaults and misconfigurations - such as role-assignable groups with inappropriate owners, service principals with dangerous permissions, and weak group governance baselines that enable privilege escalation through group membership manipulation.</p>
<h2 id="scenario-deep-dive---step-by-step-solution-walkthrough">Scenario deep dive - step-by-step solution walkthrough<a hidden class="anchor" aria-hidden="true" href="#scenario-deep-dive---step-by-step-solution-walkthrough">#</a></h2>
<p>You can find the full walkthrough and accompanying commands in the EntraGoat GitHub repository under <a href="https://github.com/Semperis/EntraGoat/blob/main/solutions/EntraGoat-Scenario3-Solution.ps1">solutions/EntraGoat-Scenario3-Solution.ps1</a>.</p>
<h3 id="step-1-initial-foothold">Step 1: Initial foothold<a hidden class="anchor" aria-hidden="true" href="#step-1-initial-foothold">#</a></h3>
<p>We begin Scenario 3 with access to a compromised low-privileged user named <strong>Michael Chen</strong>, an IT support specialist. The background story tells us Michael owns several security groups - a misconfiguration that sets the stage for escalation.</p>
<p><img alt="A screen shot of a computer  AI-generated content may be incorrect." loading="lazy" src="/posts/scenario3/Picture2.png"></p>
<p>We authenticate with his credentials using <strong>Connect-MgGraph</strong> and then run <strong>Get-MgContext</strong> to confirm our current security context.</p>
<p><img alt="A screenshot of a computer program  AI-generated content may be incorrect." loading="lazy" src="/posts/scenario3/Picture3.png"></p>
<h3 id="step-2-enumeration">Step 2: Enumeration<a hidden class="anchor" aria-hidden="true" href="#step-2-enumeration">#</a></h3>
<p>Next, since the hint points us in this direction, we enumerate all groups owned by the current user:</p>
<p><img alt="A screen shot of a computer  AI-generated content may be incorrect." loading="lazy" src="/posts/scenario3/Picture4.png"></p>
<p>We discover that he owns 6 groups in total. To assess privilege escalation potential, we check whether any of them are role-assignable and actually have roles assigned:</p>
<p><img alt="A screen shot of a computer  AI-generated content may be incorrect." loading="lazy" src="/posts/scenario3/Picture5.png"></p>
<p>One group immediately stands out: <strong>IT Application Managers</strong>, which holds the <strong>Application Administrator</strong> role.
This role is powerful as it grants full control over all application registrations and service principals in the tenant, including the ability to add secrets or certificates to any 3rd party applications (in case they aren’t configured with app instance lock). Then, the attacker can use the SP identity to authenticate to the tenant via the OAuth 2.0 client credential grant flow, operating in an <strong>app-only context</strong> that bypasses user-centric protections.</p>
<p>__________</p>
<p><strong>Note:</strong></p>
<p>The enumeration steps above can be wrapped into dedicated helper functions (for example, <strong>Get-GroupsOwnedBy</strong> for ownership and <strong>Get-GroupRoles</strong> for assigned roles) to make the process more interactive and verbose, similar to how open-source tools present results. The implementation:</p>
<p><img alt="A screen shot of a computer program  AI-generated content may be incorrect." loading="lazy" src="/posts/scenario3/Picture6.png"></p>
<p><img alt="A screen shot of a computer code  AI-generated content may be incorrect." loading="lazy" src="/posts/scenario3/Picture7.png"></p>
<p>Here’s how the flashy output looks like when we run this enumeration function with the current user’s ID:</p>
<p><img loading="lazy" src="/posts/scenario3/Picture8.png"></p>
<p>While this can be helpful in large environments, Microsoft Graph also provides a far more efficient cmdlet: <strong>Get-MgUserOwnedObject</strong></p>
<p><img loading="lazy" src="/posts/scenario3/Picture9.png"></p>
<p><strong>Get-MgUserOwnedObject</strong> enumerates <strong>all directory objects owned by a user</strong>, eliminating the need to query each object type (groups, devices, apps and SPs) individually, unlike how we intentionally implemented. The command can be tweaked a bit with Sonnet to get a nicer output:</p>
<p><img loading="lazy" src="/posts/scenario3/Picture10.png"></p>
<p>The command <strong>Get-MgUserOwnedObject</strong> typically makes <strong>one API request</strong> to <a href="https://graph.microsoft.com/v1.0/users/%7BuserId%7D/ownedObjects">https://graph.microsoft.com/v1.0/users/{userId}/ownedObjects</a> (maybe 1-2 more in case of pagination), with the rest handled by local PowerShell logic to process, extract, and format the response.</p>
<p>By comparison, the <strong>Get-GroupsOwnedBy</strong> function we created, which might be more interactive and user-friendly, makes <strong>100-1000x API requests</strong> even though it only checks for one type of owned object.</p>
<p>When selecting enumeration tools, it’s always a good idea to prioritize efficiency - <strong>Fewer API calls mean</strong> fewer logs and <strong>a smaller detection footprint.</strong> There are many awesome (and some less-awesome) open-source tools for enumerating Entra ID environments. The key point is that although tools can be useful shortcuts, they should never be used as black boxes. If you can read the source code, do it. Take the time to understand how the queries are constructed, what API endpoints are being hit, and what data is actually being returned. Tools are only as effective as the operator’s understanding of their methods and limitations (:</p>
<p>__________</p>
<h3 id="step-3-building-the-attack-chain">Step 3: Building the attack chain<a hidden class="anchor" aria-hidden="true" href="#step-3-building-the-attack-chain">#</a></h3>
<p>Owning a group with <strong>Application Administrator</strong> rights presents significant privilege escalation potential, because once we add ourselves as a member, we can manage (== add a client secret to*) any* service principal in the tenant, which opens multiple routes to tenant compromise.
But adding ourselves right now would be noisy and unnecessary from an OPSEC perspective. First, we should confirm there is a <strong>privileged SP</strong> we can leverage to reach the next chain on the attack – the GA role. <em>Time to hunt for high-value SPs.</em></p>
<p>__________</p>
<p>**Note:**For this walkthrough, we’ll keep the spotlight on enumerating SPs with privileged roles that can reset the GA’s password with only a few steps:</p>
<ul>
<li>Privileged Role Administrator (PRA)</li>
<li>Privileged Authentication Administrator (PAA)</li>
<li>Global Administrator (GA)</li>
</ul>
<p>That said, in a real tenant you wouldn’t want to stop there. It’s just as important to enumerate SPs with other roles and with <strong>powerful app permissions,</strong> as those can open up equally dangerous escalation paths, as seen in Scenario 2.</p>
<p>__________</p>
<p>We’ll start by using the function <strong>Get-MgRoleManagementDirectoryRoleAssignment</strong> to check if any SPs are directly assigned privileged roles:</p>
<p><img loading="lazy" src="/posts/scenario3/Picture11.png"></p>
<p>Result? Nothing. Not a single service principal is directly holding GA, PRA or PAA in my tenant.</p>
<p>But <strong>that’s not the full set of SPs that might have privileged roles assigned</strong>. Entra ID allows role-assignable groups, and just like users, SPs can be members of those groups. If a group has GA, PRA or PAA, then any SP inside it inherits those privileges. This is an often-overlooked escalation vector.</p>
<p>So, next, we enumerate all groups that are role-assignable and check which ones have the roles assigned (it&rsquo;s not the most aesthetic code, but it will do the job):</p>
<p><img loading="lazy" src="/posts/scenario3/Picture12.png"></p>
<p>Now that we have a list of privileged groups, we need to inspect their <strong>members</strong>. Since the function <strong>Get-MgGroupMember</strong> operates on v1.0, it doesn’t show SP memberships. To solve that, we’ll wrap a direct call to the /beta endpoint in a helper function:</p>
<p><img loading="lazy" src="/posts/scenario3/Picture13.png"></p>
<p>Now we can use it to filter for SP membership in the privileged groups:</p>
<p><img loading="lazy" src="/posts/scenario3/Picture14.png"></p>
<p>Now things get interesting – we discovered potential SPs with privileged roles. Depending on your environment, you may have many more.</p>
<p>We can simply pick the first one <strong>($targetSPs[0]),</strong> but for the sake of consistency (and so every player has the same path without risking tenant stability), we’ll zero in on the <strong>Identity Management Portal</strong>. That one is part of the setup script and won’t break anything in case of a change in functionality <em>(fingers crossed)</em>.</p>
<p><img loading="lazy" src="/posts/scenario3/Picture15.png"></p>
<p>At this stage, we’ve mapped out the full attack chain. Here’s how we’ll move from the current low-priv user all the way to Global Admin:</p>
<ol>
<li>Add ourselves to the <strong>IT Application Managers</strong> group to inherit the <strong>Application Administrator</strong> role.</li>
<li>Use that role to add a client secret to the <strong>Identity Management Portal</strong> service principal.</li>
<li>Authenticate as that service principal.</li>
<li>Use its inherited PAA privileges to reset the Global Admin’s password.</li>
<li>Log in as the Global Admin with the new password.</li>
<li>Retrieve the flag to prove compromise.</li>
</ol>
<h3 id="step-4-executing-the-attack-path">Step 4: Executing the attack path<a hidden class="anchor" aria-hidden="true" href="#step-4-executing-the-attack-path">#</a></h3>
<p>First, we add ourselves as members to the <strong>IT Application Managers</strong> group:</p>
<p><img loading="lazy" src="/posts/scenario3/Picture16.png"></p>
<p>Since tokens don’t update automatically, we can disconnect and reauthenticate to pull a fresh access token with the new assigned role. As discussed in Scenario 2, this step is not a must, as most Entra ID endpoints usuallyevaluate role assignments dynamically.</p>
<p>We can use the <strong>parse-JWTToken</strong> cmdlet by BARK to see the added app admin role (<strong>wids</strong> field within the JWT token) assigned to the user.</p>
<p><img alt="A screenshot of a computer program  AI-generated content may be incorrect." loading="lazy" src="/posts/scenario3/Picture17.png"></p>
<p>With <strong>Application Administrator</strong> rights at our hands, we can add backdoor access to the <strong>Identity Management Portal</strong> like we did in Scenario 1:</p>
<p><img alt="A computer screen with text  AI-generated content may be incorrect." loading="lazy" src="/posts/scenario3/Picture18.png"></p>
<p>That gives us persistent SP access, independent of any user account. We can use it to authenticate as the SP to Entra ID:</p>
<p><img alt="A screenshot of a computer program  AI-generated content may be incorrect." loading="lazy" src="/posts/scenario3/Picture19.png"></p>
<p>The next step is to find the target GA user and reset its password:</p>
<p><img alt="A screen shot of a computer program  AI-generated content may be incorrect." loading="lazy" src="/posts/scenario3/Picture20.png"></p>
<p>Finally, we can authenticate as the GA and retrieve the flag. We’ll use <strong>Get-MSGraphTokenWithUsernamePassword</strong> to authenticate from the CLI (just like in scenario 2), but you can also set a TAP (like in scenario 1) and log interactively from the Azure portal or the Entra ID admin center.</p>
<p><img alt="A screenshot of a computer program  AI-generated content may be incorrect." loading="lazy" src="/posts/scenario3/Picture21.png"></p>
<p>Scenario 3 completed!</p>
<h3 id="step-5-cleanup">Step 5: Cleanup<a hidden class="anchor" aria-hidden="true" href="#step-5-cleanup">#</a></h3>
<p>Don’t forget to run the cleanup script to revert the tenant environment back to its original state:</p>
<p><img alt="A screenshot of a computer program  AI-generated content may be incorrect." loading="lazy" src="/posts/scenario3/Picture22.png"></p>
<h2 id="conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h2>
<p>Scenario 3 reveals how seemingly minor misconfigurations in group ownership can cascade into full tenant compromise. The attack chain (from low-privileged user to Global Administrator) required no sophisticated techniques, just an understanding of Entra ID&rsquo;s delegation model, how role inheritance works, and the control plane of service principal identities.</p>
<p>The key takeaway: group ownership is administrative delegation in disguise**. When users own role-assignable groups, they effectively control any roles assigned to those groups.** Service principals amplify this risk because they can be compromised through multiple pathways beyond traditional credential theft - ownership relationships, application management roles, and programmatic access.</p>
<p>The scenario shows that in modern cloud identity environments, privilege escalation paths are rarely linear. They weave through ownership relationships, group memberships, and service principal identities in ways that <strong>require defenders to think systematically about identity relationships rather than individual permissions</strong>. The low-privileged IT support specialist didn&rsquo;t need to break anything - the escalation path was built into the tenant&rsquo;s configuration from the get-go.</p>
<p><strong>Endnote</strong></p>
<ol>
<li><a href="https://github.com/BloodHoundAD/BARK">https://github.com/BloodHoundAD/BARK</a></li>
</ol>
<p><strong>Disclaimer</strong></p>
<p>This content is provided for educational and informational purposes only. It is intended to promote awareness and responsible remediation of security vulnerabilities that may exist on systems you own or are authorized to test. Unauthorized use of this information for malicious purposes, exploitation, or unlawful access is strictly prohibited. We do not endorse or condone any illegal activity and disclaims any liability arising from misuse of the material. Additionally, We do not guarantee the accuracy or completeness of the content and assumes no liability for any damages resulting from its use.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="next" href="http://localhost:1313/posts/scenario6/">
    <span class="title">Next »</span>
    <br>
    <span>EntraGoat Scenario 6: Exploiting Chained Misconfigurations to Impersonate Global Admin in Entra ID</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share EntraGoat Scenario 3: Exploiting Group Ownership in Entra ID on x"
            href="https://x.com/intent/tweet/?text=EntraGoat%20Scenario%203%3a%20Exploiting%20Group%20Ownership%20in%20Entra%20ID&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fscenario3%2f&amp;hashtags=">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share EntraGoat Scenario 3: Exploiting Group Ownership in Entra ID on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fscenario3%2f&amp;title=EntraGoat%20Scenario%203%3a%20Exploiting%20Group%20Ownership%20in%20Entra%20ID&amp;summary=EntraGoat%20Scenario%203%3a%20Exploiting%20Group%20Ownership%20in%20Entra%20ID&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2fscenario3%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share EntraGoat Scenario 3: Exploiting Group Ownership in Entra ID on reddit"
            href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2fscenario3%2f&title=EntraGoat%20Scenario%203%3a%20Exploiting%20Group%20Ownership%20in%20Entra%20ID">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share EntraGoat Scenario 3: Exploiting Group Ownership in Entra ID on facebook"
            href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2fscenario3%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share EntraGoat Scenario 3: Exploiting Group Ownership in Entra ID on whatsapp"
            href="https://api.whatsapp.com/send?text=EntraGoat%20Scenario%203%3a%20Exploiting%20Group%20Ownership%20in%20Entra%20ID%20-%20http%3a%2f%2flocalhost%3a1313%2fposts%2fscenario3%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share EntraGoat Scenario 3: Exploiting Group Ownership in Entra ID on telegram"
            href="https://telegram.me/share/url?text=EntraGoat%20Scenario%203%3a%20Exploiting%20Group%20Ownership%20in%20Entra%20ID&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fscenario3%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share EntraGoat Scenario 3: Exploiting Group Ownership in Entra ID on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=EntraGoat%20Scenario%203%3a%20Exploiting%20Group%20Ownership%20in%20Entra%20ID&u=http%3a%2f%2flocalhost%3a1313%2fposts%2fscenario3%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">TomerN</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
